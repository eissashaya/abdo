<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartExam - تطبيق الاختبارات الإلكترونية</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #5d5fef;
            --primary-light: #8b8dff;
            --primary-dark: #4a4bc5;
            --secondary-color: #6c63ff;
            --secondary-light: #8a85ff;
            --success-color: #4cc9f0;
            --success-light: #80e0ff;
            --warning-color: #ff6b6b;
            --warning-light: #ff9999;
            --danger-color: #7209b7;
            --danger-light: #9d4edd;
            --light-color: #f8f9fa;
            --dark-color: #2d3047;
            --admin-color: #9d4edd;
            --teacher-color: #4361ee;
            --student-color: #4cc9f0;
            --sidebar-color: #2d3047;
            --card-bg: #ffffff;
            --hover-color: #f8f9fa;
            --border-color: #e9ecef;
            --text-primary: #2d3047;
            --text-secondary: #6c757d;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --gradient-success: linear-gradient(135deg, var(--success-color), #2fb5e0);
            --gradient-warning: linear-gradient(135deg, var(--warning-color), #ff5252);
            --gradient-danger: linear-gradient(135deg, var(--danger-color), #9d4edd);
            --gradient-admin: linear-gradient(135deg, var(--admin-color), #7b2cbf);
            --gradient-teacher: linear-gradient(135deg, var(--teacher-color), #3a56e4);
            --gradient-student: linear-gradient(135deg, var(--student-color), #2fb5e0);
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 5px 15px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.12);
            --shadow-xl: 0 15px 35px rgba(0, 0, 0, 0.15);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f8fafc;
            color: var(--text-primary);
            line-height: 1.7;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(93, 95, 239, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(108, 99, 255, 0.05) 0%, transparent 20%);
            min-height: 100vh;
        }

        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap');

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* تنسيقات عامة */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            padding: 30px;
            margin-bottom: 25px;
            transition: all var(--transition-normal);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient-primary);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .card-title {
            color: var(--secondary-color);
            font-weight: 800;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(108, 99, 255, 0.2);
            font-size: 1.5rem;
            position: relative;
        }

        .card-title::after {
            content: '';
            position: absolute;
            bottom: -2px;
            right: 0;
            width: 100px;
            height: 2px;
            background: var(--gradient-primary);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 14px 28px;
            border-radius: var(--radius-md);
            border: none;
            cursor: pointer;
            font-weight: 700;
            transition: all var(--transition-normal);
            text-decoration: none;
            font-size: 15px;
            gap: 10px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(255,255,255,0.1), transparent);
            border-radius: inherit;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--secondary-color));
        }

        .btn-success {
            background: var(--gradient-success);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #2fb5e0, var(--success-color));
        }

        .btn-warning {
            background: var(--gradient-warning);
            color: white;
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, #ff5252, var(--warning-color));
        }

        .btn-danger {
            background: var(--gradient-danger);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #9d4edd, var(--danger-color));
        }

        .btn-admin {
            background: var(--gradient-admin);
            color: white;
        }

        .btn-teacher {
            background: var(--gradient-teacher);
            color: white;
        }

        .btn-student {
            background: var(--gradient-student);
            color: white;
        }

        /* صفحة تسجيل الدخول */
        .login-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #2d3047 0%, var(--primary-color) 50%, var(--secondary-color) 100%);
            position: relative;
            overflow: hidden;
            padding: 20px;
        }

        .login-page::before {
            content: '';
            position: absolute;
            width: 300%;
            height: 300%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255,255,255,0.1) 0%, transparent 50%);
            animation: pulse 20s infinite linear;
        }

        @keyframes pulse {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .login-container {
            width: 100%;
            max-width: 480px;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .login-card {
            text-align: center;
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .login-header {
            padding: 40px 20px;
            background: var(--gradient-primary);
            color: white;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .login-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .login-header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .login-header p {
            opacity: 0.9;
            font-size: 1.2rem;
            font-weight: 300;
        }

        .login-content {
            padding: 0 35px 35px;
        }

        .user-type-selector {
            display: flex;
            justify-content: space-between;
            margin-bottom: 35px;
            gap: 12px;
        }

        .user-type-btn {
            flex: 1;
            padding: 20px 15px;
            border: 2px solid rgba(108, 99, 255, 0.2);
            background: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all var(--transition-normal);
            text-align: center;
            border-radius: var(--radius-md);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .user-type-btn::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .user-type-btn:not(:last-child) {
            margin-left: 12px;
        }

        .user-type-btn.active {
            border-color: var(--primary-color);
            background-color: rgba(93, 95, 239, 0.1);
            font-weight: bold;
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .user-type-btn.active::before {
            opacity: 0.1;
        }

        .user-type-btn i {
            display: block;
            font-size: 32px;
            margin-bottom: 15px;
            color: var(--primary-color);
            position: relative;
            z-index: 1;
        }

        .user-type-btn.active i {
            color: var(--secondary-color);
        }

        .user-type-btn span {
            position: relative;
            z-index: 1;
        }

        .login-form .form-group {
            margin-bottom: 30px;
            text-align: right;
        }

        .login-form label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: var(--text-primary);
            font-size: 16px;
        }

        .login-form input, .login-form select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(108, 99, 255, 0.2);
            border-radius: var(--radius-md);
            font-size: 16px;
            transition: all var(--transition-normal);
            background: rgba(255, 255, 255, 0.9);
        }

        .login-form input:focus, .login-form select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(93, 95, 239, 0.2);
            background: white;
        }

        /* رأس الصفحة */
        .header {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-lg);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            background: rgba(255, 255, 255, 0.2);
            width: 55px;
            height: 55px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .logo-text h2 {
            color: white;
            font-size: 1.9rem;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .logo-text p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.95rem;
            margin-top: 3px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 20px;
            box-shadow: var(--shadow-md);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-details span:first-child {
            font-weight: 800;
            font-size: 17px;
        }

        .user-type-badge {
            padding: 6px 15px;
            border-radius: 20px;
            color: white;
            font-size: 13px;
            font-weight: bold;
            text-align: center;
            display: inline-block;
            margin-top: 5px;
            width: fit-content;
            box-shadow: var(--shadow-sm);
        }

        .badge-admin {
            background: var(--gradient-admin);
        }

        .badge-teacher {
            background: var(--gradient-teacher);
        }

        .badge-student {
            background: var(--gradient-student);
        }

        /* لوحة التحكم */
        .dashboard {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 300px;
            background: var(--sidebar-color);
            color: white;
            padding: 25px 0;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 80px;
            height: calc(100vh - 80px);
            overflow-y: auto;
            backdrop-filter: blur(10px);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-header {
            padding: 0 25px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .sidebar-header h3 {
            font-size: 1.4rem;
            font-weight: 800;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 8px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 18px 25px;
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            transition: all var(--transition-normal);
            border-right: 4px solid transparent;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .sidebar-menu a::before {
            content: '';
            position: absolute;
            top: 0;
            right: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0.1;
            transition: right var(--transition-normal);
        }

        .sidebar-menu a:hover::before, .sidebar-menu a.active::before {
            right: 0;
        }

        .sidebar-menu a:hover, .sidebar-menu a.active {
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border-right-color: var(--student-color);
            padding-right: 30px;
        }

        .sidebar-menu i {
            margin-left: 15px;
            width: 24px;
            text-align: center;
            font-size: 20px;
        }

        .main-content {
            flex: 1;
            padding: 35px;
            background-color: #f8fafc;
            background-image: 
                radial-gradient(circle at 100% 0%, rgba(93, 95, 239, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 0% 100%, rgba(108, 99, 255, 0.03) 0%, transparent 50%);
        }

        .page-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 2px solid rgba(108, 99, 255, 0.1);
        }

        .page-title h2 {
            color: var(--secondary-color);
            font-weight: 900;
            font-size: 2rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        .page-title p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 30px;
            margin-bottom: 45px;
        }

        .stat-card {
            text-align: center;
            padding: 35px 25px;
            border-radius: var(--radius-lg);
            background: white;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .stat-card:hover::before {
            opacity: 0.03;
        }

        .stat-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            font-size: 36px;
            color: white;
            box-shadow: var(--shadow-md);
            position: relative;
            z-index: 1;
        }

        .stat-icon.admin {
            background: var(--gradient-admin);
        }

        .stat-icon.teacher {
            background: var(--gradient-teacher);
        }

        .stat-icon.student {
            background: var(--gradient-student);
        }

        .stat-icon.primary {
            background: var(--gradient-primary);
        }

        .stat-card h3 {
            font-size: 42px;
            margin-bottom: 10px;
            color: var(--secondary-color);
            font-weight: 900;
            position: relative;
            z-index: 1;
        }

        .stat-card p {
            color: var(--text-secondary);
            font-size: 16px;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        /* الجداول */
        .table-container {
            overflow-x: auto;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(108, 99, 255, 0.1);
            background: white;
            position: relative;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background-color: white;
        }

        table th, table td {
            padding: 18px 22px;
            text-align: right;
            border-bottom: 1px solid rgba(108, 99, 255, 0.1);
        }

        table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 700;
            font-size: 16px;
            border: none;
            position: sticky;
            top: 0;
        }

        table th:first-child {
            border-top-right-radius: var(--radius-lg);
        }

        table th:last-child {
            border-top-left-radius: var(--radius-lg);
        }

        table tr:hover {
            background-color: rgba(93, 95, 239, 0.03);
        }

        table tr:last-child td {
            border-bottom: none;
        }

        .actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 10px 18px;
            border-radius: var(--radius-sm);
            font-size: 14px;
            cursor: pointer;
            border: none;
            font-weight: 700;
            transition: all var(--transition-normal);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: var(--shadow-sm);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* شاشة الاختبار */
        .exam-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .exam-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 2px solid rgba(108, 99, 255, 0.1);
        }

        .timer {
            background: var(--gradient-warning);
            color: white;
            padding: 15px 30px;
            border-radius: var(--radius-md);
            font-weight: bold;
            font-size: 24px;
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: pulseTimer 2s infinite;
        }

        @keyframes pulseTimer {
            0% { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4); }
            50% { box-shadow: 0 4px 25px rgba(255, 107, 107, 0.6); }
            100% { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4); }
        }

        .timer.warning {
            background: var(--gradient-danger);
            animation: pulseWarning 1s infinite;
        }

        @keyframes pulseWarning {
            0% { transform: scale(1); box-shadow: 0 4px 15px rgba(114, 9, 183, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 4px 25px rgba(114, 9, 183, 0.6); }
            100% { transform: scale(1); box-shadow: 0 4px 15px rgba(114, 9, 183, 0.4); }
        }

        .question-navigation {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
            padding: 25px;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        .question-nav-btn {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-md);
            border: 2px solid rgba(108, 99, 255, 0.2);
            background-color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all var(--transition-normal);
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .question-nav-btn.active {
            border-color: var(--primary-color);
            background: var(--gradient-primary);
            color: white;
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        .question-nav-btn.answered {
            background: var(--gradient-success);
            color: white;
            border-color: var(--success-color);
        }

        .question-card {
            margin-bottom: 35px;
            padding: 35px;
        }

        .question-text {
            font-size: 22px;
            margin-bottom: 30px;
            color: var(--text-primary);
            line-height: 1.7;
            font-weight: 700;
            padding-right: 15px;
            border-right: 4px solid var(--primary-light);
        }

        .options-container {
            margin-right: 25px;
        }

        .option {
            margin-bottom: 18px;
            padding: 20px 25px;
            border: 2px solid rgba(108, 99, 255, 0.2);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            font-size: 17px;
            position: relative;
            overflow: hidden;
        }

        .option::before {
            content: '';
            position: absolute;
            top: 0;
            right: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: all var(--transition-normal);
        }

        .option:hover::before {
            right: 0;
            opacity: 0.05;
        }

        .option:hover {
            border-color: rgba(93, 95, 239, 0.5);
            transform: translateX(-5px);
        }

        .option.selected {
            border-color: var(--primary-color);
            background-color: rgba(93, 95, 239, 0.1);
            transform: translateX(-10px);
            box-shadow: var(--shadow-sm);
        }

        .option.selected::before {
            right: 0;
            opacity: 0.1;
        }

        .option input {
            margin-left: 18px;
            width: 22px;
            height: 22px;
            cursor: pointer;
        }

        .exam-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 45px;
        }

        /* شاشة النتائج */
        .result-card {
            text-align: center;
            padding: 60px 35px;
        }

        .result-icon {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 35px;
            font-size: 70px;
            color: white;
            box-shadow: var(--shadow-lg);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }

        .result-icon.success {
            background: var(--gradient-success);
        }

        .result-icon.warning {
            background: var(--gradient-warning);
        }

        .result-icon.danger {
            background: var(--gradient-danger);
        }

        .score {
            font-size: 85px;
            font-weight: 900;
            margin-bottom: 15px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .score-percentage {
            font-size: 32px;
            color: var(--text-secondary);
            margin-bottom: 35px;
            font-weight: 700;
        }

        .answers-review {
            text-align: right;
            margin-top: 45px;
            background: white;
            padding: 35px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        .answer-item {
            padding: 25px;
            border-radius: var(--radius-md);
            margin-bottom: 18px;
            border-right: 5px solid transparent;
            transition: all var(--transition-normal);
        }

        .answer-item.correct {
            background-color: rgba(76, 201, 240, 0.1);
            border-right-color: var(--success-color);
        }

        .answer-item.incorrect {
            background-color: rgba(255, 107, 107, 0.1);
            border-right-color: var(--warning-color);
        }

        .answer-item:hover {
            transform: translateX(-5px);
        }

        /* أنظمة التصميم المتجاوب */
        @media (max-width: 1200px) {
            .sidebar {
                width: 270px;
            }
        }

        @media (max-width: 992px) {
            .dashboard {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                order: 2;
                padding: 15px 0;
            }
            
            .sidebar-header {
                padding: 0 20px 20px;
            }
            
            .sidebar-menu {
                display: flex;
                overflow-x: auto;
                padding: 0 20px;
            }
            
            .sidebar-menu li {
                flex: 0 0 auto;
                margin-bottom: 0;
            }
            
            .sidebar-menu a {
                white-space: nowrap;
                border-right: none;
                border-bottom: 4px solid transparent;
                padding: 15px;
            }
            
            .sidebar-menu a:hover, .sidebar-menu a.active {
                border-right: none;
                border-bottom-color: var(--student-color);
            }
            
            .main-content {
                padding: 25px;
            }
        }

        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 20px;
            }
            
            .exam-header {
                flex-direction: column;
                gap: 20px;
            }
            
            .exam-actions {
                flex-direction: column;
                gap: 20px;
            }
            
            .exam-actions .btn {
                width: 100%;
            }
            
            .page-title {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
        }

        @media (max-width: 576px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
            
            .login-container {
                padding: 10px;
            }
            
            .login-content {
                padding: 0 20px 20px;
            }
            
            .user-type-selector {
                flex-direction: column;
            }
            
            .user-type-btn:not(:last-child) {
                margin-left: 0;
                margin-bottom: 15px;
            }
        }

        /* تخصيصات إضافية */
        .welcome-message {
            background: var(--gradient-primary);
            color: white;
            padding: 35px;
            border-radius: var(--radius-lg);
            margin-bottom: 35px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        .welcome-message::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }
        
        .welcome-message h3 {
            font-size: 2.2rem;
            margin-bottom: 15px;
            font-weight: 900;
            position: relative;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .welcome-message p {
            opacity: 0.9;
            font-size: 1.3rem;
            position: relative;
            z-index: 1;
        }
        
        .feature-card {
            display: flex;
            align-items: center;
            padding: 30px;
            background: white;
            border-radius: var(--radius-lg);
            margin-bottom: 25px;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100%;
            background: var(--gradient-primary);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: var(--radius-md);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            margin-left: 25px;
            box-shadow: var(--shadow-md);
            flex-shrink: 0;
        }
        
        .feature-content h4 {
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-weight: 800;
            font-size: 1.3rem;
        }
        
        .feature-content p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* تأثيرات إضافية */
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ripple {
            position: relative;
            overflow: hidden;
        }

        .ripple::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }

        .ripple:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }

        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            20% {
                transform: scale(25, 25);
                opacity: 0.3;
            }
            100% {
                opacity: 0;
                transform: scale(40, 40);
            }
        }

        /* شريط التقدم */
        .progress-bar {
            height: 8px;
            background: rgba(108, 99, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* أقسام مخصصة */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(108, 99, 255, 0.1);
        }

        .section-title {
            color: var(--secondary-color);
            font-weight: 800;
            font-size: 1.8rem;
        }

        .section-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* بطاقات مخصصة */
        .info-card {
            padding: 25px;
            border-radius: var(--radius-lg);
            background: white;
            box-shadow: var(--shadow-md);
            border-left: 5px solid var(--primary-color);
            transition: all var(--transition-normal);
        }

        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .info-card h4 {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-weight: 800;
        }

        /* ألوان إضافية */
        .text-gradient {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .bg-gradient {
            background: var(--gradient-primary);
        }

        .border-gradient {
            border: 2px solid transparent;
            background: linear-gradient(white, white) padding-box,
                        var(--gradient-primary) border-box;
        }

        /* عناصر الواجهة */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: white;
            min-width: 200px;
            box-shadow: var(--shadow-lg);
            border-radius: var(--radius-md);
            z-index: 1000;
            padding: 10px 0;
        }

        .dropdown:hover .dropdown-content {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .dropdown-item {
            padding: 12px 20px;
            text-decoration: none;
            display: block;
            color: var(--text-primary);
            transition: all var(--transition-fast);
        }

        .dropdown-item:hover {
            background: rgba(93, 95, 239, 0.1);
            color: var(--primary-color);
        }

        /* تخصيصات الصفحات */
        .dashboard-widget {
            background: white;
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-md);
            margin-bottom: 25px;
            transition: all var(--transition-normal);
        }

        .dashboard-widget:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        /* أزرار الإجراءات */
        .btn-sm {
            padding: 10px 20px;
            font-size: 14px;
        }

        .btn-lg {
            padding: 18px 35px;
            font-size: 17px;
        }

        .btn-block {
            width: 100%;
        }

        /* أيقونات */
        .icon-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-primary);
            color: white;
            font-size: 24px;
            box-shadow: var(--shadow-md);
        }

        /* أدوات الإشعارات */
        .alert {
            padding: 20px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            border-right: 5px solid transparent;
        }

        .alert-success {
            background: rgba(76, 201, 240, 0.1);
            border-right-color: var(--success-color);
            color: var(--success-color);
        }

        .alert-warning {
            background: rgba(255, 107, 107, 0.1);
            border-right-color: var(--warning-color);
            color: var(--warning-color);
        }

        .alert-danger {
            background: rgba(114, 9, 183, 0.1);
            border-right-color: var(--danger-color);
            color: var(--danger-color);
        }

        /* عناصر الإدخال */
        .input-group {
            position: relative;
            margin-bottom: 25px;
        }

        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(108, 99, 255, 0.2);
            border-radius: var(--radius-md);
            font-size: 16px;
            transition: all var(--transition-normal);
            background: white;
        }

        .input-group label {
            position: absolute;
            top: -10px;
            right: 15px;
            background: white;
            padding: 0 10px;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 14px;
        }

        /* علامات */
        .badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            text-align: center;
        }

        .badge-primary {
            background: rgba(93, 95, 239, 0.1);
            color: var(--primary-color);
        }

        .badge-success {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success-color);
        }

        .badge-warning {
            background: rgba(255, 107, 107, 0.1);
            color: var(--warning-color);
        }

        .badge-danger {
            background: rgba(114, 9, 183, 0.1);
            color: var(--danger-color);
        }

        /* تحسينات للشكل العام */
        .smooth-transition {
            transition: all var(--transition-normal);
        }

        .hover-lift:hover {
            transform: translateY(-5px);
        }

        .hover-grow:hover {
            transform: scale(1.05);
        }

        .hover-shine::after {
            content: '';
            position: absolute;
            top: 0;
            right: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            transition: 0.5s;
        }

        .hover-shine:hover::after {
            right: 100%;
        }
    </style>
</head>
<body>
    <!-- صفحة تسجيل الدخول -->
    <div id="loginPage" class="login-page">
        <div class="login-container">
            <div class="login-card card">
                <div class="login-header">
                    <h1><i class="fas fa-graduation-cap"></i> SmartExam</h1>
                    <p>نظام إدارة الاختبارات الإلكترونية المتكامل</p>
                </div>
                
                <div class="login-content">
                    <div class="user-type-selector">
                        <div class="user-type-btn" id="adminBtn" onclick="selectUserType('admin')">
                            <i class="fas fa-user-shield"></i>
                            <span>مدير النظام</span>
                        </div>
                        <div class="user-type-btn" id="teacherBtn" onclick="selectUserType('teacher')">
                            <i class="fas fa-chalkboard-teacher"></i>
                            <span>مدرس</span>
                        </div>
                        <div class="user-type-btn active" id="studentBtn" onclick="selectUserType('student')">
                            <i class="fas fa-user-graduate"></i>
                            <span>طالب</span>
                        </div>
                    </div>
                    
                    <form class="login-form" id="loginForm">
                        <div class="form-group">
                            <label for="email"><i class="fas fa-envelope"></i> البريد الإلكتروني</label>
                            <input type="email" id="email" placeholder="أدخل بريدك الإلكتروني" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="password"><i class="fas fa-lock"></i> كلمة المرور</label>
                            <input type="password" id="password" placeholder="أدخل كلمة المرور" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="userType"><i class="fas fa-user-tag"></i> نوع الحساب</label>
                            <select id="userType">
                                <option value="student">طالب</option>
                                <option value="teacher">مدرس</option>
                                <option value="admin">مدير</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 16px; margin-top: 15px;">
                            <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
                        </button>
                    </form>
                    
                    <div style="margin-top: 30px; font-size: 14px; color: var(--text-secondary); background: rgba(93, 95, 239, 0.05); padding: 20px; border-radius: var(--radius-md); border-right: 4px solid var(--primary-light);">
                        <p style="font-weight: 700; margin-bottom: 12px; color: var(--primary-color);"><i class="fas fa-info-circle"></i> للحسابات التجريبية، استخدم:</p>
                        <ul style="text-align: right; padding-right: 25px; list-style: none;">
                            <li style="margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid rgba(93, 95, 239, 0.1);"><strong>مدير:</strong> admin@smartschool.edu / password</li>
                            <li style="margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid rgba(93, 95, 239, 0.1);"><strong>مدرس:</strong> teacher@smartschool.edu / password</li>
                            <li><strong>طالب:</strong> student@smartschool.edu / password</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- لوحة التحكم الرئيسية -->
    <div id="dashboard" style="display: none;">
        <!-- رأس الصفحة -->
        <header class="header">
            <div class="container header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="logo-text">
                        <h2>SmartExam</h2>
                        <p>نظام إدارة الاختبارات الإلكترونية</p>
                    </div>
                </div>
                
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">
                        <!-- سيتم تعبئته ديناميكيًا -->
                    </div>
                    <div class="user-details">
                        <span id="loggedInUserName">عيسى شايع</span>
                        <span id="loggedInUserType" class="user-type-badge badge-admin">مدير</span>
                    </div>
                    <button class="btn btn-warning" onclick="logout()" style="margin-right: 15px;">
                        <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                    </button>
                </div>
            </div>
        </header>
        
        <!-- لوحة التحكم -->
        <div class="dashboard">
            <!-- القائمة الجانبية -->
            <nav class="sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-bars"></i> القائمة الرئيسية</h3>
                </div>
                <ul class="sidebar-menu" id="sidebarMenu">
                    <!-- سيتم ملء القائمة ديناميكيًا حسب نوع المستخدم -->
                </ul>
            </nav>
            
            <!-- المحتوى الرئيسي -->
            <main class="main-content">
                <div class="container">
                    <!-- سيتم ملء المحتوى ديناميكيًا -->
                    <div id="mainContent">
                        <div class="page-title">
                            <h2 id="pageTitle">لوحة التحكم</h2>
                            <p id="currentDate">تاريخ اليوم: </p>
                        </div>
                        
                        <div id="dashboardContent">
                            <!-- سيتم ملء محتوى لوحة التحكم حسب نوع المستخدم -->
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- شاشة أداء الاختبار -->
    <div id="examScreen" style="display: none;">
        <!-- رأس الصفحة -->
        <header class="header">
            <div class="container header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="logo-text">
                        <h2>SmartExam</h2>
                        <p>أداء الاختبار</p>
                    </div>
                </div>
                
                <div class="user-info">
                    <div class="timer" id="examTimer">
                        <i class="fas fa-clock"></i> 30:00
                    </div>
                    <button class="btn btn-danger" onclick="exitExam()" style="margin-right: 15px;">
                        <i class="fas fa-times"></i> الخروج
                    </button>
                </div>
            </div>
        </header>
        
        <!-- محتوى الاختبار -->
        <div class="container exam-container">
            <div id="examContent">
                <!-- سيتم ملء محتوى الاختبار ديناميكيًا -->
            </div>
        </div>
    </div>

    <!-- شاشة عرض النتائج -->
    <div id="resultScreen" style="display: none;">
        <!-- رأس الصفحة -->
        <header class="header">
            <div class="container header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="logo-text">
                        <h2>SmartExam</h2>
                        <p>نتيجة الاختبار</p>
                    </div>
                </div>
                
                <div class="user-info">
                    <span id="resultTitle">النتيجة</span>
                    <button class="btn btn-primary" onclick="goToDashboard()" style="margin-right: 15px;">
                        <i class="fas fa-home"></i> العودة للرئيسية
                    </button>
                </div>
            </div>
        </header>
        
        <!-- محتوى النتائج -->
        <div class="container">
            <div id="resultContent">
                <!-- سيتم ملء محتوى النتائج ديناميكيًا -->
            </div>
        </div>
    </div>

    <!-- شاشة إنشاء اختبار -->
    <div id="createExamScreen" style="display: none;">
        <!-- رأس الصفحة -->
        <header class="header">
            <div class="container header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="logo-text">
                        <h2>SmartExam</h2>
                        <p>إنشاء اختبار جديد</p>
                    </div>
                </div>
                
                <div class="user-info">
                    <span>إنشاء اختبار</span>
                    <button class="btn btn-primary" onclick="goToDashboard()" style="margin-right: 15px;">
                        <i class="fas fa-home"></i> العودة
                    </button>
                </div>
            </div>
        </header>
        
        <!-- محتوى إنشاء الاختبار -->
        <div class="container">
            <div id="createExamContent">
                <!-- سيتم ملء محتوى إنشاء الاختبار ديناميكيًا -->
            </div>
        </div>
    </div>

    <script>
        // بيانات التطبيق الأساسية
        let currentUser = null;
        let currentPage = 'dashboard';
        let examData = null;
        let examAnswers = {};
        let examTimer = null;
        let examTimeLeft = 0;
        let currentExam = null;
        let currentQuestionIndex = 0;

        // بيانات أولية للمستخدمين (لتجربة التطبيق)
        const sampleUsers = {
            'admin@smartschool.edu': { id: 1, name: 'عيسى شايع', type: 'admin', password: 'password' },
            'teacher@smartschool.edu': { id: 2, name: 'محمد قريع', type: 'teacher', password: 'password' },
            'student@smartschool.edu': { id: 3, name: 'عيسى شايع', type: 'student', password: 'password' }
        };

        // بيانات المواد البرمجية للمدرس
        const teacherSubjects = [
            {
                id: 1,
                name: 'برمجة الويب',
                code: 'WEB101',
                credits: 3,
                department: 'تقنية المعلومات',
                groups: ['المجموعة أ', 'المجموعة ب'],
                studentsCount: 45,
                examsCount: 3,
                averageScore: 85,
                schedule: [
                    { day: 'الأحد', time: '09:00 - 11:00', classroom: 'مختبر 201' },
                    { day: 'الثلاثاء', time: '10:00 - 12:00', classroom: 'مختبر 201' }
                ],
                description: 'تعلم أساسيات برمجة الويب باستخدام HTML, CSS, JavaScript',
                topics: ['HTML5', 'CSS3', 'JavaScript', 'Responsive Design', 'DOM Manipulation']
            },
            {
                id: 2,
                name: 'قواعد البيانات',
                code: 'DB202',
                credits: 4,
                department: 'تقنية المعلومات',
                groups: ['المجموعة ج'],
                studentsCount: 30,
                examsCount: 2,
                averageScore: 78,
                schedule: [
                    { day: 'الإثنين', time: '08:00 - 10:00', classroom: 'مختبر 302' },
                    { day: 'الأربعاء', time: '11:00 - 13:00', classroom: 'قاعة 203' }
                ],
                description: 'تصميم وإدارة قواعد البيانات باستخدام SQL وMySQL',
                topics: ['SQL Queries', 'Database Design', 'Normalization', 'MySQL', 'Indexing']
            },
            {
                id: 3,
                name: 'هياكل البيانات',
                code: 'DS303',
                credits: 3,
                department: 'علوم الحاسب',
                groups: ['المجموعة أ', 'المجموعة ج'],
                studentsCount: 40,
                examsCount: 1,
                averageScore: 82,
                schedule: [
                    { day: 'الأحد', time: '13:00 - 15:00', classroom: 'قاعة 105' },
                    { day: 'الخميس', time: '12:00 - 14:00', classroom: 'مختبر 401' }
                ],
                description: 'دراسة هياكل البيانات الأساسية والخوارزميات',
                topics: ['Arrays', 'Linked Lists', 'Stacks', 'Queues', 'Trees', 'Sorting Algorithms']
            },
            {
                id: 4,
                name: 'برمجة تطبيقات الجوال',
                code: 'MOB404',
                credits: 4,
                department: 'هندسة البرمجيات',
                groups: ['المجموعة ب'],
                studentsCount: 35,
                examsCount: 2,
                averageScore: 88,
                schedule: [
                    { day: 'الإثنين', time: '14:00 - 16:00', classroom: 'مختبر 501' },
                    { day: 'الأربعاء', time: '09:00 - 11:00', classroom: 'مختبر 501' }
                ],
                description: 'تطوير تطبيقات الجوال باستخدام React Native',
                topics: ['React Native', 'Mobile UI', 'API Integration', 'State Management', 'Deployment']
            },
            {
                id: 5,
                name: 'أمن المعلومات',
                code: 'SEC505',
                credits: 3,
                department: 'أمن الشبكات',
                groups: ['المجموعة أ'],
                studentsCount: 25,
                examsCount: 1,
                averageScore: 90,
                schedule: [
                    { day: 'الثلاثاء', time: '14:00 - 16:00', classroom: 'قاعة 301' },
                    { day: 'الخميس', time: '10:00 - 12:00', classroom: 'مختبر 601' }
                ],
                description: 'مبادئ أمن المعلومات وحماية الأنظمة',
                topics: ['Encryption', 'Authentication', 'Network Security', 'Cyber Threats', 'Security Protocols']
            }
        ];

        // بيانات الاختبارات (لتجربة التطبيق)
        const sampleExams = [
            {
                id: 1,
                title: 'اختبار برمجة الويب - الفصل الأول',
                subject: 'برمجة الويب',
                teacher: 'محمد قريع',
                group: 'المجموعة أ',
                duration: 45,
                startTime: '2024-12-10T10:00:00',
                endTime: '2024-12-10T18:00:00',
                questions: [
                    {
                        id: 1,
                        text: 'ما هي وظيفة الوسم <div> في HTML؟',
                        type: 'mcq',
                        options: ['إنشاء قسم في الصفحة', 'إدراج صورة', 'إنشاء جدول', 'إضافة رابط'],
                        correctAnswer: 0
                    },
                    {
                        id: 2,
                        text: 'CSS هي اختصار لـ Cascading Style Sheets.',
                        type: 'truefalse',
                        correctAnswer: true
                    },
                    {
                        id: 3,
                        text: 'ما هي نتيجة تنفيذ الكود التالي في JavaScript: console.log(2 + "2")؟',
                        type: 'mcq',
                        options: ['4', '22', 'خطأ', 'undefined'],
                        correctAnswer: 1
                    },
                    {
                        id: 4,
                        text: 'اشرح الفرق بين let و var في JavaScript.',
                        type: 'essay',
                        maxScore: 10
                    }
                ],
                totalScore: 25
            },
            {
                id: 2,
                title: 'اختبار قواعد البيانات النصفي',
                subject: 'قواعد البيانات',
                teacher: 'محمد قريع',
                group: 'المجموعة ج',
                duration: 60,
                startTime: '2024-12-12T09:00:00',
                endTime: '2024-12-12T17:00:00',
                questions: [
                    {
                        id: 1,
                        text: 'ما هي لغة الاستعلامات المستخدمة في قواعد البيانات العلائقية؟',
                        type: 'mcq',
                        options: ['SQL', 'Python', 'Java', 'C++'],
                        correctAnswer: 0
                    },
                    {
                        id: 2,
                        text: 'ما هي الأوامر المستخدمة للتعامل مع البيانات في SQL؟',
                        type: 'essay',
                        maxScore: 15
                    }
                ],
                totalScore: 20
            }
        ];

        // بيانات الطلاب والمجموعات والمواد (لتجربة التطبيق)
        const sampleData = {
            students: [
                { id: 1, name: 'برهان الزمر', email: 'student@smartschool.edu', group: 'المجموعة أ', major: 'تقنية المعلومات', level: 'الثاني', gpa: 3.5 },
                { id: 2, name: 'محمد قريع', email: 'ali@smartschool.edu', group: 'المجموعة أ', major: 'تقنية المعلومات', level: 'الثاني', gpa: 3.2 },
                { id: 3, name: 'مازن أبو راس', email: 'fatima@smartschool.edu', group: 'المجموعة ب', major: 'المحاسبة', level: 'الثالث', gpa: 3.8 }
            ],
            groups: [
                { id: 1, name: 'المجموعة أ', subject: 'برمجة الويب', teacher: 'محمد قريع', studentsCount: 25 },
                { id: 2, name: 'المجموعة ب', subject: 'برمجة الويب', teacher: 'محمد قريع', studentsCount: 20 },
                { id: 3, name: 'المجموعة ج', subject: 'قواعد البيانات', teacher: 'محمد قريع', studentsCount: 30 }
            ],
            subjects: [
                { id: 1, name: 'برمجة الويب', code: 'WEB101', credits: 3, department: 'تقنية المعلومات' },
                { id: 2, name: 'قواعد البيانات', code: 'DB202', credits: 4, department: 'تقنية المعلومات' },
                { id: 3, name: 'هياكل البيانات', code: 'DS303', credits: 3, department: 'علوم الحاسب' }
            ],
            universities: [
                { id: 1, name: 'جامعة التقنية والعلوم', location: 'الرياض', established: 2000 },
                { id: 2, name: 'جامعة النجاح', location: 'صنعاء', established: 1995 }
            ],
            majors: [
                { id: 1, name: 'تقنية المعلومات', department: 'علوم الحاسب', university: 'جامعة التقنية والعلوم' },
                { id: 2, name: 'هندسة البرمجيات', department: 'هندسة البرمجيات', university: 'جامعة التقنية والعلوم' },
                { id: 3, name: 'أمن المعلومات', department: 'أمن الشبكات', university: 'جامعة النجاح' }
            ]
        };

        // تهيئة التطبيق عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            // تحديث التاريخ الحالي
            const currentDate = new Date().toLocaleDateString('ar-SA', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('currentDate').textContent = `تاريخ اليوم: ${currentDate}`;
            
            // إضافة حدث لتسجيل الدخول
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });
            
            // تحديد نوع المستخدم الافتراضي
            selectUserType('student');
            
            // تحميل البيانات من localStorage إذا كانت موجودة
            loadDataFromLocalStorage();
        });

        // تحديد نوع المستخدم
        function selectUserType(type) {
            document.querySelectorAll('.user-type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`${type}Btn`).classList.add('active');
            document.getElementById('userType').value = type;
        }

        // تسجيل الدخول
        function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const userType = document.getElementById('userType').value;
            
            // التحقق من بيانات المستخدم
            if (sampleUsers[email] && sampleUsers[email].password === password && sampleUsers[email].type === userType) {
                currentUser = {
                    email: email,
                    name: sampleUsers[email].name,
                    type: userType,
                    id: sampleUsers[email].id
                };
                
                // حفظ بيانات المستخدم في localStorage
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // عرض لوحة التحكم
                showDashboard();
            } else {
                alert('بيانات الدخول غير صحيحة. الرجاء المحاولة مرة أخرى.');
            }
        }

        // تسجيل الخروج
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            
            // إيقاف أي مؤقتات نشطة
            if (examTimer) {
                clearInterval(examTimer);
            }
            
            // العودة إلى صفحة تسجيل الدخول
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
            
            // إعادة تعيين النموذج
            document.getElementById('loginForm').reset();
        }

        // تحميل البيانات من localStorage
        function loadDataFromLocalStorage() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
        }

        // عرض لوحة التحكم
        function showDashboard() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('examScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('createExamScreen').style.display = 'none';
            
            // تحديث معلومات المستخدم في الرأس
            document.getElementById('loggedInUserName').textContent = currentUser.name;
            
            // تحديث شارة نوع المستخدم
            const userTypeBadge = document.getElementById('loggedInUserType');
            userTypeBadge.textContent = currentUser.type === 'admin' ? 'مدير' : 
                                         currentUser.type === 'teacher' ? 'مدرس' : 'طالب';
            userTypeBadge.className = `user-type-badge badge-${currentUser.type}`;
            
            // تحديث الصورة الرمزية للمستخدم
            const userAvatar = document.getElementById('userAvatar');
            const nameParts = currentUser.name.split(' ');
            const initials = nameParts.length > 1 ? 
                nameParts[0].charAt(0) + nameParts[1].charAt(0) : 
                nameParts[0].charAt(0);
            userAvatar.textContent = initials;
            
            // تحديث القائمة الجانبية والمحتوى الرئيسي
            updateSidebar();
            loadDashboardContent();
        }

        // تحديث القائمة الجانبية حسب نوع المستخدم
        function updateSidebar() {
            const sidebarMenu = document.getElementById('sidebarMenu');
            sidebarMenu.innerHTML = '';
            
            let menuItems = [];
            
            if (currentUser.type === 'admin') {
                menuItems = [
                    { id: 'dashboard', icon: 'fas fa-tachometer-alt', text: 'لوحة التحكم', active: currentPage === 'dashboard' },
                    { id: 'universities', icon: 'fas fa-university', text: 'إدارة الجامعات', active: currentPage === 'universities' },
                    { id: 'majors', icon: 'fas fa-graduation-cap', text: 'إدارة التخصصات', active: currentPage === 'majors' },
                    { id: 'subjects', icon: 'fas fa-book', text: 'إدارة المواد', active: currentPage === 'subjects' },
                    { id: 'groups', icon: 'fas fa-users', text: 'إدارة المجموعات', active: currentPage === 'groups' },
                    { id: 'students', icon: 'fas fa-user-graduate', text: 'إدارة الطلاب', active: currentPage === 'students' },
                    { id: 'users', icon: 'fas fa-user-cog', text: 'إدارة المستخدمين', active: currentPage === 'users' },
                    { id: 'reports', icon: 'fas fa-chart-bar', text: 'التقارير والإحصائيات', active: currentPage === 'reports' }
                ];
            } else if (currentUser.type === 'teacher') {
                menuItems = [
                    { id: 'dashboard', icon: 'fas fa-tachometer-alt', text: 'لوحة التحكم', active: currentPage === 'dashboard' },
                    { id: 'mySubjects', icon: 'fas fa-book', text: 'موادي الدراسية', active: currentPage === 'mySubjects' },
                    { id: 'myGroups', icon: 'fas fa-users', text: 'مجموعاتي', active: currentPage === 'myGroups' },
                    { id: 'createExam', icon: 'fas fa-plus-circle', text: 'إنشاء اختبار جديد', active: currentPage === 'createExam' },
                    { id: 'myExams', icon: 'fas fa-clipboard-list', text: 'اختباراتي', active: currentPage === 'myExams' },
                    { id: 'results', icon: 'fas fa-chart-line', text: 'نتائج الطلاب', active: currentPage === 'results' }
                ];
            } else if (currentUser.type === 'student') {
                menuItems = [
                    { id: 'dashboard', icon: 'fas fa-tachometer-alt', text: 'لوحة التحكم', active: currentPage === 'dashboard' },
                    { id: 'availableExams', icon: 'fas fa-clipboard-check', text: 'الاختبارات المتاحة', active: currentPage === 'availableExams' },
                    { id: 'myResults', icon: 'fas fa-award', text: 'نتائجي', active: currentPage === 'myResults' },
                    { id: 'myProfile', icon: 'fas fa-user', text: 'ملفي الشخصي', active: currentPage === 'myProfile' }
                ];
            }
            
            menuItems.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <a href="#" class="${item.active ? 'active' : ''}" onclick="navigateTo('${item.id}'); return false;">
                        <i class="${item.icon}"></i> ${item.text}
                    </a>
                `;
                sidebarMenu.appendChild(li);
            });
        }

        // التنقل بين الصفحات
        function navigateTo(page) {
            currentPage = page;
            updateSidebar();
            
            if (page === 'createExam') {
                showCreateExamScreen();
            } else {
                loadDashboardContent();
            }
        }

        // تحميل محتوى لوحة التحكم حسب الصفحة الحالية
        function loadDashboardContent() {
            const dashboardContent = document.getElementById('dashboardContent');
            const pageTitle = document.getElementById('pageTitle');
            
            // تحديث عنوان الصفحة
            pageTitle.textContent = getPageTitle(currentPage);
            
            if (currentPage === 'dashboard') {
                loadDashboardHome();
            } else if (currentPage === 'students' && currentUser.type === 'admin') {
                loadStudentsManagement();
            } else if (currentPage === 'subjects' && currentUser.type === 'admin') {
                loadSubjectsManagement();
            } else if (currentPage === 'groups' && currentUser.type === 'admin') {
                loadGroupsManagement();
            } else if (currentPage === 'universities' && currentUser.type === 'admin') {
                loadUniversitiesManagement();
            } else if (currentPage === 'majors' && currentUser.type === 'admin') {
                loadMajorsManagement();
            } else if (currentPage === 'users' && currentUser.type === 'admin') {
                loadUsersManagement();
            } else if (currentPage === 'reports' && currentUser.type === 'admin') {
                loadReportsManagement();
            } else if (currentPage === 'availableExams' && currentUser.type === 'student') {
                loadAvailableExams();
            } else if (currentPage === 'myResults' && currentUser.type === 'student') {
                loadStudentResults();
            } else if (currentPage === 'myExams' && currentUser.type === 'teacher') {
                loadTeacherExams();
            } else if (currentPage === 'results' && currentUser.type === 'teacher') {
                loadTeacherResults();
            } else if (currentPage === 'mySubjects' && currentUser.type === 'teacher') {
                loadTeacherSubjects();
            } else if (currentPage === 'myGroups' && currentUser.type === 'teacher') {
                loadTeacherGroups();
            } else if (currentPage === 'myProfile' && currentUser.type === 'student') {
                // عرض الملف الشخصي المنظم للطالب
                const nameParts = currentUser.name.split(' ');
                const initials = nameParts.length > 1 ? (nameParts[0].charAt(0) + nameParts[1].charAt(0)) : nameParts[0].charAt(0);
                dashboardContent.innerHTML = `
                    <div class="card">
                        <h3 class="card-title">ملفي الشخصي</h3>
                        <div style="display:flex;gap:25px;align-items:flex-start;flex-wrap:wrap;">
                            <div style="flex:0 0 240px;text-align:center;">
                                <div style="width:180px;height:180px;border-radius:var(--radius-lg);overflow:hidden;margin:0 auto;display:flex;align-items:center;justify-content:center;color:#fff;font-size:56px;background:var(--gradient-primary);box-shadow:var(--shadow-lg);border:5px solid white;">
                                    ${initials}
                                </div>
                                <h4 style="margin-top:20px;color:var(--secondary-color);font-weight:800;">${currentUser.name}</h4>
                                <p style="color:var(--text-secondary);font-size:16px;">طالب</p>
                                <div style="margin-top:20px;padding:15px;background:rgba(93, 95, 239, 0.05);border-radius:var(--radius-md);">
                                    <div style="font-size:14px;color:var(--text-secondary);">الرقم الجامعي</div>
                                    <div style="font-weight:700;color:var(--primary-color);font-size:18px;">${currentUser.id || 'غير محدد'}</div>
                                </div>
                            </div>
                            <div style="flex:1;min-width:280px;">
                                <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:20px;margin-bottom:30px;">
                                    <div style="padding:20px;background:white;border-radius:var(--radius-md);box-shadow:var(--shadow-sm);border-right:4px solid var(--primary-light);">
                                        <div style="font-weight:700;color:var(--text-secondary);margin-bottom:8px;">البريد الإلكتروني</div>
                                        <div style="font-size:16px;font-weight:600;color:var(--text-primary);">${currentUser.email}</div>
                                    </div>
                                    <div style="padding:20px;background:white;border-radius:var(--radius-md);box-shadow:var(--shadow-sm);border-right:4px solid var(--success-color);">
                                        <div style="font-weight:700;color:var(--text-secondary);margin-bottom:8px;">الكلية</div>
                                        <div style="font-size:16px;font-weight:600;color:var(--text-primary);">الحاسوب</div>
                                    </div>
                                    <div style="padding:20px;background:white;border-radius:var(--radius-md);box-shadow:var(--shadow-sm);border-right:4px solid var(--warning-color);">
                                        <div style="font-weight:700;color:var(--text-secondary);margin-bottom:8px;">القسم</div>
                                        <div style="font-size:16px;font-weight:600;color:var(--text-primary);">تقنيه معلومات</div>
                                    </div>
                                    <div style="padding:20px;background:white;border-radius:var(--radius-md);box-shadow:var(--shadow-sm);border-right:4px solid var(--danger-color);">
                                        <div style="font-weight:700;color:var(--text-secondary);margin-bottom:8px;">الهاتف</div>
                                        <div style="font-size:16px;font-weight:600;color:var(--text-primary);">+967 776295164</div>
                                    </div>
                                </div>
                                
                                <div style="background:white;border-radius:var(--radius-md);padding:25px;box-shadow:var(--shadow-sm);margin-bottom:25px;">
                                    <h4 style="color:var(--secondary-color);margin-bottom:20px;font-weight:800;"><i class="fas fa-info-circle"></i> معلومات إضافية</h4>
                                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                                        <div>
                                            <div style="font-weight:700;color:var(--text-secondary);font-size:14px;">تاريخ الميلاد</div>
                                            <div style="font-weight:600;color:var(--text-primary);">01/01/2000</div>
                                        </div>
                                        <div>
                                            <div style="font-weight:700;color:var(--text-secondary);font-size:14px;">العنوان</div>
                                            <div style="font-weight:600;color:var(--text-primary);">المدينة اب اليمن</div>
                                        </div>
                                        <div>
                                            <div style="font-weight:700;color:var(--text-secondary);font-size:14px;">الحالة الأكاديمية</div>
                                            <div style="font-weight:600;color:var(--text-primary);">نشط</div>
                                        </div>
                                        <div>
                                            <div style="font-weight:700;color:var(--text-secondary);font-size:14px;">سنة الالتحاق</div>
                                            <div style="font-weight:600;color:var(--text-primary);">2023</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="margin-top:25px;display:flex;gap:15px;flex-wrap:wrap;">
                                    <button class="btn btn-success" onclick="editProfile()">
                                        <i class="fas fa-edit"></i> تعديل الملف
                                    </button>
                                    <button class="btn btn-primary" onclick="navigateTo('myResults')">
                                        <i class="fas fa-award"></i> عرض نتائجي
                                    </button>
                                    <button class="btn btn-warning">
                                        <i class="fas fa-lock"></i> تغيير كلمة المرور
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                dashboardContent.innerHTML = `
                    <div class="card">
                        <h3 class="card-title">${getPageTitle(currentPage)}</h3>
                        <p style="color:var(--text-secondary);font-size:16px;margin-bottom:25px;">هذه الصفحة قيد التطوير. سيتم إضافة المحتوى قريبًا.</p>
                        <div style="text-align: center; margin: 40px 0;">
                            <div style="width:120px;height:120px;border-radius:50%;background:var(--gradient-primary);display:flex;align-items:center;justify-content:center;margin:0 auto 30px;font-size:50px;color:white;">
                                <i class="fas fa-tools"></i>
                            </div>
                            <h4 style="color:var(--secondary-color);font-weight:700;margin-bottom:15px;">قريبًا!</h4>
                            <p style="color:var(--text-secondary);max-width:500px;margin:0 auto;">جاري العمل على تطوير هذه الصفحة لتحقيق أفضل تجربة مستخدم.</p>
                        </div>
                    </div>
                `;
            }
        }

        // تحميل إدارة الجامعات
        function loadUniversitiesManagement() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>إدارة الجامعات</h2>
                    <button class="btn btn-success" onclick="showAddUniversityModal()">
                        <i class="fas fa-plus"></i> إضافة جامعة جديدة
                    </button>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon admin">
                            <i class="fas fa-university"></i>
                        </div>
                        <h3>${sampleData.universities.length}</h3>
                        <p>عدد الجامعات</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <h3>${sampleData.majors.length}</h3>
                        <p>التخصصات المتاحة</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon teacher">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <h3>5</h3>
                        <p>أعضاء هيئة التدريس</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon student">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <h3>${sampleData.students.length}</h3>
                        <p>الطلاب المسجلين</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">قائمة الجامعات</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>اسم الجامعة</th>
                                    <th>المدينة/الموقع</th>
                                    <th>سنة التأسيس</th>
                                    <th>عدد التخصصات</th>
                                    <th>الحالة</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sampleData.universities.map((university, index) => `
                                    <tr>
                                        <td>${university.id}</td>
                                        <td>
                                            <div style="display: flex; align-items: center; gap: 12px;">
                                                <div style="width: 45px; height: 45px; border-radius: var(--radius-md); background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; color: white; box-shadow: var(--shadow-sm);">
                                                    <i class="fas fa-university"></i>
                                                </div>
                                                <div>
                                                    <strong style="color:var(--secondary-color);">${university.name}</strong><br>
                                                    <small style="color:var(--text-secondary);">${university.location}</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>${university.location}</td>
                                        <td>${university.established}</td>
                                        <td>
                                            <span class="badge badge-primary">
                                                ${sampleData.majors.filter(m => m.university === university.name).length} تخصص
                                            </span>
                                        </td>
                                        <td>
                                            <span class="badge badge-success" style="padding: 8px 15px;">
                                                نشطة
                                            </span>
                                        </td>
                                        <td class="actions">
                                            <button class="action-btn btn-primary" onclick="viewUniversityDetails(${university.id})">
                                                <i class="fas fa-eye"></i> عرض
                                            </button>
                                            <button class="action-btn btn-warning" onclick="editUniversity(${university.id})">
                                                <i class="fas fa-edit"></i> تعديل
                                            </button>
                                            <button class="action-btn btn-danger" onclick="deleteUniversity(${university.id})">
                                                <i class="fas fa-trash"></i> حذف
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">إحصائيات الجامعات</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 30px; margin-top: 25px;">
                        ${sampleData.universities.map(university => {
                            const universityMajors = sampleData.majors.filter(m => m.university === university.name);
                            return `
                                <div class="info-card">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                                        <div>
                                            <h4 style="color: var(--secondary-color); margin-bottom: 8px; font-weight: 800;">${university.name}</h4>
                                            <div style="display: flex; align-items: center; gap: 10px;">
                                                <i class="fas fa-map-marker-alt" style="color: var(--text-secondary); font-size: 14px;"></i>
                                                <span style="color: var(--text-secondary); font-size: 14px;">${university.location}</span>
                                            </div>
                                        </div>
                                        <div class="badge badge-primary" style="padding: 8px 16px; font-size: 14px;">
                                            ${universityMajors.length} تخصص
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 25px;">
                                        <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 5px;">سنة التأسيس</div>
                                        <div style="font-weight: 700; color: var(--primary-color);">${university.established}</div>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-size: 12px; color: var(--text-secondary);">
                                                <i class="fas fa-graduation-cap"></i> ${universityMajors.length} تخصص
                                            </div>
                                        </div>
                                        <button class="btn btn-primary btn-sm" onclick="viewUniversityDetails(${university.id})">
                                            <i class="fas fa-info-circle"></i> التفاصيل
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // تحميل إدارة التخصصات
        function loadMajorsManagement() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>إدارة التخصصات</h2>
                    <button class="btn btn-success" onclick="showAddMajorModal()">
                        <i class="fas fa-plus"></i> إضافة تخصص جديد
                    </button>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon admin">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <h3>${sampleData.majors.length}</h3>
                        <p>عدد التخصصات</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-university"></i>
                        </div>
                        <h3>${[...new Set(sampleData.majors.map(m => m.university))].length}</h3>
                        <p>جامعات مختلفة</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon teacher">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <h3>${[...new Set(sampleData.majors.map(m => m.department))].length}</h3>
                        <p>أقسام أكاديمية</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon student">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3>${sampleData.subjects.length}</h3>
                        <p>مادة دراسية</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">قائمة التخصصات</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>اسم التخصص</th>
                                    <th>القسم</th>
                                    <th>الجامعة</th>
                                    <th>عدد المواد</th>
                                    <th>عدد الطلاب</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sampleData.majors.map((major, index) => {
                                    const subjectsCount = sampleData.subjects.filter(s => s.department === major.department).length;
                                    const studentsCount = sampleData.students.filter(s => s.major === major.name).length;
                                    return `
                                        <tr>
                                            <td>${major.id}</td>
                                            <td>
                                                <div style="display: flex; align-items: center; gap: 12px;">
                                                    <div style="width: 45px; height: 45px; border-radius: var(--radius-md); background: var(--gradient-warning); display: flex; align-items: center; justify-content: center; color: white; box-shadow: var(--shadow-sm);">
                                                        <i class="fas fa-graduation-cap"></i>
                                                    </div>
                                                    <div>
                                                        <strong style="color:var(--secondary-color);">${major.name}</strong><br>
                                                        <small style="color:var(--text-secondary);">${major.department}</small>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>${major.department}</td>
                                            <td>${major.university}</td>
                                            <td>
                                                <span class="badge badge-warning">
                                                    ${subjectsCount} مادة
                                                </span>
                                            </td>
                                            <td>
                                                <span class="badge badge-success">
                                                    ${studentsCount} طالب
                                                </span>
                                            </td>
                                            <td class="actions">
                                                <button class="action-btn btn-primary" onclick="viewMajorDetails(${major.id})">
                                                    <i class="fas fa-eye"></i> عرض
                                                </button>
                                                <button class="action-btn btn-warning" onclick="editMajor(${major.id})">
                                                    <i class="fas fa-edit"></i> تعديل
                                                </button>
                                                <button class="action-btn btn-danger" onclick="deleteMajor(${major.id})">
                                                    <i class="fas fa-trash"></i> حذف
                                                </button>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">التخصصات حسب الجامعات</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(370px, 1fr)); gap: 30px; margin-top: 30px;">
                        ${sampleData.universities.map(university => {
                            const universityMajors = sampleData.majors.filter(m => m.university === university.name);
                            return `
                                <div class="info-card">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 25px;">
                                        <div>
                                            <h3 style="color: var(--secondary-color); margin-bottom: 8px; font-weight: 800;">${university.name}</h3>
                                            <p style="color: var(--text-secondary); font-size: 15px;">
                                                <i class="fas fa-map-marker-alt"></i> ${university.location}
                                            </p>
                                        </div>
                                        <div style="background: rgba(93, 95, 239, 0.1); color: var(--primary-color); padding: 10px 18px; border-radius: var(--radius-md); font-weight: 700; font-size: 16px;">
                                            ${universityMajors.length} تخصص
                                        </div>
                                    </div>
                                    
                                    <div style="display: grid; gap: 15px; margin-bottom: 30px;">
                                        ${universityMajors.map(major => `
                                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(76, 201, 240, 0.05); border-radius: var(--radius-md); border-right: 3px solid var(--success-color);">
                                                <div>
                                                    <div style="font-weight: 700; color: var(--text-primary); font-size: 16px;">${major.name}</div>
                                                    <div style="color: var(--text-secondary); font-size: 14px;">${major.department}</div>
                                                </div>
                                                <button class="btn btn-primary btn-sm" onclick="viewMajorDetails(${major.id})" style="padding: 8px 12px;">
                                                    <i class="fas fa-arrow-left"></i>
                                                </button>
                                            </div>
                                        `).join('')}
                                    </div>
                                    
                                    <div style="text-align: center;">
                                        <button class="btn btn-success" style="width: 100%;" onclick="showAddMajorModal('${university.name}')">
                                            <i class="fas fa-plus"></i> إضافة تخصص جديد
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // تحميل إدارة المستخدمين
        function loadUsersManagement() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            // بيانات المستخدمين الإضافية
            const allUsers = [
                { id: 1, name: 'عيسى شايع', email: 'admin@smartschool.edu', type: 'admin', status: 'active', phone: '+967 776295164', createdAt: '2024-01-15' },
                { id: 2, name: 'محمد قريع', email: 'teacher@smartschool.edu', type: 'teacher', status: 'active', phone: '+967 777777777', createdAt: '2024-02-10' },
                { id: 3, name: 'برهان الزمر', email: 'student@smartschool.edu', type: 'student', status: 'active', phone: '+967 788888888', createdAt: '2024-03-05' },
                { id: 4, name: 'أحمد سعيد', email: 'ahmed@smartschool.edu', type: 'teacher', status: 'inactive', phone: '+967 799999999', createdAt: '2024-01-20' },
                { id: 5, name: 'سارة محمد', email: 'sara@smartschool.edu', type: 'student', status: 'active', phone: '+967 755555555', createdAt: '2024-02-28' },
                { id: 6, name: 'خالد عبدالله', email: 'khaled@smartschool.edu', type: 'admin', status: 'active', phone: '+967 744444444', createdAt: '2024-01-10' }
            ];
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>إدارة المستخدمين</h2>
                    <button class="btn btn-success" onclick="showAddUserModal()">
                        <i class="fas fa-plus"></i> إضافة مستخدم جديد
                    </button>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon admin">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <h3>${allUsers.filter(u => u.type === 'admin').length}</h3>
                        <p>مديرين</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon teacher">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <h3>${allUsers.filter(u => u.type === 'teacher').length}</h3>
                        <p>مدرسين</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon student">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <h3>${allUsers.filter(u => u.type === 'student').length}</h3>
                        <p>طلاب</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <h3>${allUsers.filter(u => u.status === 'active').length}</h3>
                        <p>مستخدمين نشطين</p>
                    </div>
                </div>
                
                <div class="card">
                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                            <input type="text" id="searchUser" placeholder="بحث عن مستخدم..." style="padding: 14px; flex: 1; min-width: 260px; border-radius: var(--radius-md); border: 2px solid rgba(108, 99, 255, 0.2); font-size: 15px;">
                            <select id="filterUserType" style="padding: 14px; border-radius: var(--radius-md); border: 2px solid rgba(108, 99, 255, 0.2); font-size: 15px;">
                                <option value="">جميع الأنواع</option>
                                <option value="admin">مدير</option>
                                <option value="teacher">مدرس</option>
                                <option value="student">طالب</option>
                            </select>
                            <select id="filterUserStatus" style="padding: 14px; border-radius: var(--radius-md); border: 2px solid rgba(108, 99, 255, 0.2); font-size: 15px;">
                                <option value="">جميع الحالات</option>
                                <option value="active">نشط</option>
                                <option value="inactive">غير نشط</option>
                            </select>
                            <button class="btn btn-primary" onclick="filterUsers()">
                                <i class="fas fa-search"></i> بحث
                            </button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>المستخدم</th>
                                    <th>البريد الإلكتروني</th>
                                    <th>نوع المستخدم</th>
                                    <th>رقم الهاتف</th>
                                    <th>الحالة</th>
                                    <th>تاريخ التسجيل</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                ${allUsers.map(user => {
                                    let typeBadge = '';
                                    let statusBadge = '';
                                    
                                    if (user.type === 'admin') {
                                        typeBadge = 'badge-admin';
                                    } else if (user.type === 'teacher') {
                                        typeBadge = 'badge-teacher';
                                    } else {
                                        typeBadge = 'badge-student';
                                    }
                                    
                                    if (user.status === 'active') {
                                        statusBadge = 'badge-success';
                                    } else {
                                        statusBadge = 'badge-warning';
                                    }
                                    
                                    return `
                                        <tr>
                                            <td>${user.id}</td>
                                            <td>
                                                <div style="display: flex; align-items: center; gap: 12px;">
                                                    <div style="width: 45px; height: 45px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 18px; box-shadow: var(--shadow-sm);">
                                                        ${user.name.split(' ').map(n => n[0]).join('')}
                                                    </div>
                                                    <div>
                                                        <strong style="color:var(--secondary-color);">${user.name}</strong><br>
                                                        <small style="color:var(--text-secondary);">ID: ${user.id}</small>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>${user.email}</td>
                                            <td>
                                                <span class="user-type-badge ${typeBadge}" style="margin: 0;">
                                                    ${user.type === 'admin' ? 'مدير' : user.type === 'teacher' ? 'مدرس' : 'طالب'}
                                                </span>
                                            </td>
                                            <td>${user.phone}</td>
                                            <td>
                                                <span class="badge ${statusBadge}" style="padding: 8px 16px; font-weight: 700;">
                                                    ${user.status === 'active' ? 'نشط' : 'غير نشط'}
                                                </span>
                                            </td>
                                            <td>${user.createdAt}</td>
                                            <td class="actions">
                                                <button class="action-btn btn-primary" onclick="viewUserDetails(${user.id})">
                                                    <i class="fas fa-eye"></i> عرض
                                                </button>
                                                <button class="action-btn btn-warning" onclick="editUser(${user.id})">
                                                    <i class="fas fa-edit"></i> تعديل
                                                </button>
                                                <button class="action-btn btn-danger" onclick="deleteUser(${user.id})">
                                                    <i class="fas fa-trash"></i> حذف
                                                </button>
                                                ${user.status === 'active' ? 
                                                    `<button class="action-btn btn-warning" onclick="toggleUserStatus(${user.id}, 'inactive')">
                                                        <i class="fas fa-ban"></i> تعطيل
                                                    </button>` : 
                                                    `<button class="action-btn btn-success" onclick="toggleUserStatus(${user.id}, 'active')">
                                                        <i class="fas fa-check"></i> تفعيل
                                                    </button>`
                                                }
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">إحصائيات المستخدمين</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px;">
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, rgba(157, 78, 221, 0.1), rgba(157, 78, 221, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(157, 78, 221, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">المستخدمون النشطون</div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--danger-color);">${allUsers.filter(u => u.status === 'active').length}</div>
                            <div style="height: 5px; background: rgba(157, 78, 221, 0.2); border-radius: 3px; margin-top: 15px; overflow: hidden;">
                                <div style="width: ${(allUsers.filter(u => u.status === 'active').length / allUsers.length) * 100}%; height: 100%; background: var(--gradient-danger); border-radius: 3px;"></div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, rgba(93, 95, 239, 0.1), rgba(93, 95, 239, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(93, 95, 239, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">المستخدمون الجدد (هذا الشهر)</div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--primary-color);">3</div>
                            <div style="height: 5px; background: rgba(93, 95, 239, 0.2); border-radius: 3px; margin-top: 15px; overflow: hidden;">
                                <div style="width: 50%; height: 100%; background: var(--gradient-primary); border-radius: 3px;"></div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(255, 107, 107, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">طلبات التسجيل المعلقة</div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--warning-color);">2</div>
                            <div style="height: 5px; background: rgba(255, 107, 107, 0.2); border-radius: 3px; margin-top: 15px; overflow: hidden;">
                                <div style="width: 33%; height: 100%; background: var(--gradient-warning); border-radius: 3px;"></div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, rgba(76, 201, 240, 0.1), rgba(76, 201, 240, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(76, 201, 240, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">إجمالي المستخدمين</div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--success-color);">${allUsers.length}</div>
                            <div style="height: 5px; background: rgba(76, 201, 240, 0.2); border-radius: 3px; margin-top: 15px; overflow: hidden;">
                                <div style="width: 100%; height: 100%; background: var(--gradient-success); border-radius: 3px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // تحميل التقارير والإحصائيات
        function loadReportsManagement() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>التقارير والإحصائيات</h2>
                    <div>
                        <button class="btn btn-primary">
                            <i class="fas fa-download"></i> تصدير التقرير
                        </button>
                        <button class="btn btn-success" style="margin-right: 12px;">
                            <i class="fas fa-print"></i> طباعة
                        </button>
                    </div>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon admin">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>${sampleExams.length}</h3>
                        <p>الاختبارات المنشأة</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>${sampleData.students.length}</h3>
                        <p>الطلاب المسجلين</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon teacher">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <h3>5</h3>
                        <p>المدرسين النشطين</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon student">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <h3>82%</h3>
                        <p>متوسط النجاح</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">تقارير الاختبارات</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 35px;">
                        <div>
                            <h4 style="color: var(--secondary-color); margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid rgba(108, 99, 255, 0.1); font-weight: 800;">
                                <i class="fas fa-chart-pie"></i> توزيع النتائج
                            </h4>
                            <div style="height: 280px; display: flex; flex-direction: column; justify-content: space-around;">
                                <div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                        <span>ممتاز (90-100%)</span>
                                        <span style="font-weight: 800; color: var(--success-color);">35%</span>
                                    </div>
                                    <div style="height: 12px; background: rgba(76, 201, 240, 0.2); border-radius: var(--radius-sm); overflow: hidden;">
                                        <div style="width: 35%; height: 100%; background: var(--gradient-success); border-radius: var(--radius-sm);"></div>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                        <span>جيد جداً (75-89%)</span>
                                        <span style="font-weight: 800; color: var(--primary-color);">40%</span>
                                    </div>
                                    <div style="height: 12px; background: rgba(93, 95, 239, 0.2); border-radius: var(--radius-sm); overflow: hidden;">
                                        <div style="width: 40%; height: 100%; background: var(--gradient-primary); border-radius: var(--radius-sm);"></div>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                        <span>مقبول (50-74%)</span>
                                        <span style="font-weight: 800; color: var(--warning-color);">20%</span>
                                    </div>
                                    <div style="height: 12px; background: rgba(255, 107, 107, 0.2); border-radius: var(--radius-sm); overflow: hidden;">
                                        <div style="width: 20%; height: 100%; background: var(--gradient-warning); border-radius: var(--radius-sm);"></div>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                        <span>راسب (أقل من 50%)</span>
                                        <span style="font-weight: 800; color: var(--danger-color);">5%</span>
                                    </div>
                                    <div style="height: 12px; background: rgba(114, 9, 183, 0.2); border-radius: var(--radius-sm); overflow: hidden;">
                                        <div style="width: 5%; height: 100%; background: var(--gradient-danger); border-radius: var(--radius-sm);"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: var(--secondary-color); margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid rgba(108, 99, 255, 0.1); font-weight: 800;">
                                <i class="fas fa-chart-bar"></i> النشاط خلال الشهر
                            </h4>
                            <div style="height: 280px; display: flex; align-items: flex-end; justify-content: space-around;">
                                <div style="text-align: center;">
                                    <div style="width: 35px; height: 170px; background: rgba(76, 201, 240, 0.2); border-radius: var(--radius-sm); position: relative;">
                                        <div style="position: absolute; bottom: 0; width: 100%; height: 70%; background: var(--gradient-success); border-radius: var(--radius-sm);"></div>
                                    </div>
                                    <div style="margin-top: 12px; font-size: 13px; font-weight: 600; color: var(--text-secondary);">الأسبوع 1</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="width: 35px; height: 170px; background: rgba(76, 201, 240, 0.2); border-radius: var(--radius-sm); position: relative;">
                                        <div style="position: absolute; bottom: 0; width: 100%; height: 85%; background: var(--gradient-success); border-radius: var(--radius-sm);"></div>
                                    </div>
                                    <div style="margin-top: 12px; font-size: 13px; font-weight: 600; color: var(--text-secondary);">الأسبوع 2</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="width: 35px; height: 170px; background: rgba(76, 201, 240, 0.2); border-radius: var(--radius-sm); position: relative;">
                                        <div style="position: absolute; bottom: 0; width: 100%; height: 60%; background: var(--gradient-success); border-radius: var(--radius-sm);"></div>
                                    </div>
                                    <div style="margin-top: 12px; font-size: 13px; font-weight: 600; color: var(--text-secondary);">الأسبوع 3</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="width: 35px; height: 170px; background: rgba(76, 201, 240, 0.2); border-radius: var(--radius-sm); position: relative;">
                                        <div style="position: absolute; bottom: 0; width: 100%; height: 95%; background: var(--gradient-success); border-radius: var(--radius-sm);"></div>
                                    </div>
                                    <div style="margin-top: 12px; font-size: 13px; font-weight: 600; color: var(--text-secondary);">الأسبوع 4</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">أحدث الاختبارات</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>اسم الاختبار</th>
                                    <th>المادة</th>
                                    <th>المدرس</th>
                                    <th>عدد الطلاب</th>
                                    <th>متوسط الدرجة</th>
                                    <th>تاريخ الانتهاء</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sampleExams.map(exam => `
                                    <tr>
                                        <td><strong style="color:var(--secondary-color);">${exam.title}</strong></td>
                                        <td>${exam.subject}</td>
                                        <td>${exam.teacher}</td>
                                        <td>25</td>
                                        <td>
                                            <span class="badge badge-success" style="padding: 10px 18px; font-weight: 700;">
                                                85%
                                            </span>
                                        </td>
                                        <td>${new Date(exam.endTime).toLocaleDateString('ar-SA')}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // تحميل المواد الدراسية للمدرس (المواد البرمجية)
        function loadTeacherSubjects() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>موادي الدراسية</h2>
                    <p>إدارة المواد البرمجية التي أدرسها</p>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon teacher">
                            <i class="fas fa-laptop-code"></i>
                        </div>
                        <h3>${teacherSubjects.length}</h3>
                        <p>عدد المواد</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <h3>${teacherSubjects.reduce((total, subject) => total + subject.studentsCount, 0)}</h3>
                        <p>إجمالي الطلاب</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="fas fa-clipboard-check"></i>
                        </div>
                        <h3>${teacherSubjects.reduce((total, subject) => total + subject.examsCount, 0)}</h3>
                        <p>الاختبارات المنشأة</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>${Math.round(teacherSubjects.reduce((total, subject) => total + subject.averageScore, 0) / teacherSubjects.length)}%</h3>
                        <p>متوسط النجاح</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">قائمة المواد البرمجية</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(370px, 1fr)); gap: 30px; margin-top: 25px;">
                        ${teacherSubjects.map(subject => `
                            <div class="info-card">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                                    <div>
                                        <h3 style="color: var(--secondary-color); margin-bottom: 8px; font-weight: 800;">${subject.name}</h3>
                                        <p style="color: var(--text-secondary); font-size: 15px;">
                                            <i class="fas fa-code"></i> ${subject.code} | ${subject.credits} ساعات معتمدة
                                        </p>
                                    </div>
                                    <span class="badge badge-primary" style="padding: 8px 15px; font-size: 14px;">
                                        ${subject.department}
                                    </span>
                                </div>
                                
                                <p style="color: var(--text-secondary); margin-bottom: 25px; line-height: 1.7; font-size: 15px;">${subject.description}</p>
                                
                                <div style="margin-bottom: 25px;">
                                    <h4 style="color: var(--text-primary); margin-bottom: 12px; font-size: 16px; font-weight: 700;">المواضيع الرئيسية:</h4>
                                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                        ${subject.topics.map(topic => `
                                            <span style="background: rgba(76, 201, 240, 0.1); color: var(--success-color); padding: 8px 14px; border-radius: 20px; font-size: 13px; font-weight: 600;">
                                                ${topic}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                                    <div>
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                            <div style="width: 35px; height: 35px; border-radius: 50%; background: rgba(67, 97, 238, 0.1); display: flex; align-items: center; justify-content: center; color: var(--teacher-color);">
                                                <i class="fas fa-users"></i>
                                            </div>
                                            <div>
                                                <div style="font-size: 13px; color: var(--text-secondary);">الطلاب</div>
                                                <div style="font-weight: 700; color: var(--text-primary);">${subject.studentsCount} طالب</div>
                                            </div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="width: 35px; height: 35px; border-radius: 50%; background: rgba(76, 201, 240, 0.1); display: flex; align-items: center; justify-content: center; color: var(--success-color);">
                                                <i class="fas fa-clipboard-list"></i>
                                            </div>
                                            <div>
                                                <div style="font-size: 13px; color: var(--text-secondary);">الاختبارات</div>
                                                <div style="font-weight: 700; color: var(--text-primary);">${subject.examsCount} اختبار</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <div style="font-size: 32px; font-weight: 900; color: ${subject.averageScore >= 85 ? 'var(--success-color)' : subject.averageScore >= 70 ? 'var(--primary-color)' : 'var(--warning-color)'};">
                                            ${subject.averageScore}%
                                        </div>
                                        <div style="font-size: 13px; color: var(--text-secondary); text-align: center;">متوسط النجاح</div>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                    <button class="btn btn-primary" onclick="viewSubjectDetails(${subject.id})">
                                        <i class="fas fa-eye"></i> عرض التفاصيل
                                    </button>
                                    <button class="btn btn-success" onclick="navigateTo('createExam')">
                                        <i class="fas fa-plus"></i> إنشاء اختبار
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">جدول المحاضرات</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>المادة</th>
                                    <th>اليوم</th>
                                    <th>الوقت</th>
                                    <th>القاعة</th>
                                    <th>المجموعات</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${teacherSubjects.flatMap(subject => 
                                    subject.schedule.map(session => `
                                        <tr>
                                            <td>
                                                <div style="display: flex; align-items: center; gap: 12px;">
                                                    <div style="width: 45px; height: 45px; border-radius: var(--radius-md); background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; color: white; box-shadow: var(--shadow-sm);">
                                                        <i class="fas fa-laptop-code"></i>
                                                    </div>
                                                    <div>
                                                        <strong style="color:var(--secondary-color);">${subject.name}</strong><br>
                                                        <small style="color: var(--text-secondary);">${subject.code}</small>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>${session.day}</td>
                                            <td><span class="badge badge-warning" style="padding: 8px 14px;">${session.time}</span></td>
                                            <td>${session.classroom}</td>
                                            <td>
                                                <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                                                    ${subject.groups.map(group => `
                                                        <span style="background: rgba(76, 201, 240, 0.1); color: var(--success-color); padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: 600;">
                                                            ${group}
                                                        </span>
                                                    `).join('')}
                                                </div>
                                            </td>
                                            <td>
                                                <button class="btn btn-primary btn-sm" onclick="viewSubjectDetails(${subject.id})" style="padding: 10px 15px;">
                                                    <i class="fas fa-info-circle"></i> تفاصيل
                                                </button>
                                            </td>
                                        </tr>
                                    `)
                                ).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // تحميل مجموعات المدرس
        function loadTeacherGroups() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            const teacherGroups = sampleData.groups.filter(g => g.teacher === currentUser.name);
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>مجموعاتي</h2>
                    <p>المجموعات الدراسية التي أشرف عليها</p>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon teacher">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>${teacherGroups.length}</h3>
                        <p>عدد المجموعات</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <h3>${teacherGroups.reduce((total, group) => total + group.studentsCount, 0)}</h3>
                        <p>إجمالي الطلاب</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3>${teacherSubjects.length}</h3>
                        <p>المواد الدراسية</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <h3>82%</h3>
                        <p>متوسط الحضور</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">المجموعات الدراسية</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(370px, 1fr)); gap: 30px; margin-top: 30px;">
                        ${teacherGroups.map(group => {
                            const subject = teacherSubjects.find(s => s.name === group.subject);
                            return `
                                <div class="info-card">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 25px;">
                                        <div>
                                            <h3 style="color: var(--secondary-color); margin-bottom: 8px; font-weight: 800;">${group.name}</h3>
                                            <p style="color: var(--text-secondary); font-size: 15px;">${group.subject}</p>
                                        </div>
                                        <div style="background: rgba(93, 95, 239, 0.1); color: var(--primary-color); padding: 10px 18px; border-radius: var(--radius-md); font-weight: 800; font-size: 16px;">
                                            ${group.studentsCount} طالب
                                        </div>
                                    </div>
                                    
                                    <div style="display: grid; gap: 18px; margin-bottom: 30px;">
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="width: 45px; height: 45px; border-radius: var(--radius-md); background: rgba(67, 97, 238, 0.1); display: flex; align-items: center; justify-content: center; color: var(--primary-color);">
                                                <i class="fas fa-chalkboard-teacher"></i>
                                            </div>
                                            <div>
                                                <div style="font-weight: 700; color: var(--text-secondary); font-size: 13px;">المدرس</div>
                                                <div style="color: var(--text-primary); font-weight: 600; font-size: 15px;">${group.teacher}</div>
                                            </div>
                                        </div>
                                        
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="width: 45px; height: 45px; border-radius: var(--radius-md); background: rgba(76, 201, 240, 0.1); display: flex; align-items: center; justify-content: center; color: var(--success-color);">
                                                <i class="fas fa-calendar-alt"></i>
                                            </div>
                                            <div>
                                                <div style="font-weight: 700; color: var(--text-secondary); font-size: 13px;">مواعيد المحاضرات</div>
                                                <div style="color: var(--text-primary); font-weight: 600; font-size: 15px;">
                                                    ${subject ? subject.schedule.map(s => `${s.day} ${s.time}`).join('، ') : 'غير محدد'}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="width: 45px; height: 45px; border-radius: var(--radius-md); background: rgba(255, 107, 107, 0.1); display: flex; align-items: center; justify-content: center; color: var(--warning-color);">
                                                <i class="fas fa-clipboard-check"></i>
                                            </div>
                                            <div>
                                                <div style="font-weight: 700; color: var(--text-secondary); font-size: 13px;">الاختبارات</div>
                                                <div style="color: var(--text-primary); font-weight: 600; font-size: 15px;">
                                                    ${subject ? subject.examsCount : 0} اختبار
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 12px;">
                                        <button class="btn btn-primary" style="flex: 1;" onclick="viewGroupStudents('${group.name}')">
                                            <i class="fas fa-users"></i> عرض الطلاب
                                        </button>
                                        <button class="btn btn-success" style="flex: 1;" onclick="viewGroupExams('${group.name}')">
                                            <i class="fas fa-clipboard-list"></i> الاختبارات
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // عرض تفاصيل المادة
        function viewSubjectDetails(subjectId) {
            const subject = teacherSubjects.find(s => s.id == subjectId);
            if (!subject) return;
            
            const dashboardContent = document.getElementById('dashboardContent');
            const pageTitle = document.getElementById('pageTitle');
            
            pageTitle.textContent = `تفاصيل المادة: ${subject.name}`;
            
            dashboardContent.innerHTML = `
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3 class="card-title">${subject.name} (${subject.code})</h3>
                        <button class="btn btn-primary" onclick="loadTeacherSubjects()">
                            <i class="fas fa-arrow-right"></i> العودة للقائمة
                        </button>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(270px, 1fr)); gap: 25px; margin-bottom: 35px;">
                        <div style="background: linear-gradient(135deg, rgba(93, 95, 239, 0.1), rgba(93, 95, 239, 0.05)); padding: 25px; border-radius: var(--radius-lg); border: 1px solid rgba(93, 95, 239, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">الكود الأكاديمي</div>
                            <div style="font-size: 24px; font-weight: 900; color: var(--primary-color);">${subject.code}</div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, rgba(76, 201, 240, 0.1), rgba(76, 201, 240, 0.05)); padding: 25px; border-radius: var(--radius-lg); border: 1px solid rgba(76, 201, 240, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">الساعات المعتمدة</div>
                            <div style="font-size: 24px; font-weight: 900; color: var(--success-color);">${subject.credits} ساعة</div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05)); padding: 25px; border-radius: var(--radius-lg); border: 1px solid rgba(255, 107, 107, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">عدد الطلاب</div>
                            <div style="font-size: 24px; font-weight: 900; color: var(--warning-color);">${subject.studentsCount} طالب</div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, rgba(114, 9, 183, 0.1), rgba(114, 9, 183, 0.05)); padding: 25px; border-radius: var(--radius-lg); border: 1px solid rgba(114, 9, 183, 0.1);">
                            <div style="font-size: 15px; color: var(--text-secondary); margin-bottom: 8px;">متوسط النجاح</div>
                            <div style="font-size: 24px; font-weight: 900; color: var(--danger-color);">${subject.averageScore}%</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 35px; margin-bottom: 35px;">
                        <div>
                            <h4 style="color: var(--secondary-color); margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid rgba(108, 99, 255, 0.1); font-weight: 800;">
                                <i class="fas fa-info-circle"></i> معلومات المادة
                            </h4>
                            
                            <div style="display: grid; gap: 20px;">
                                <div>
                                    <div style="font-weight: 800; color: var(--text-primary); margin-bottom: 8px;">القسم الأكاديمي</div>
                                    <div style="color: var(--text-secondary); font-size: 16px;">${subject.department}</div>
                                </div>
                                
                                <div>
                                    <div style="font-weight: 800; color: var(--text-primary); margin-bottom: 8px;">وصف المادة</div>
                                    <div style="color: var(--text-secondary); line-height: 1.8; font-size: 16px;">${subject.description}</div>
                                </div>
                                
                                <div>
                                    <div style="font-weight: 800; color: var(--text-primary); margin-bottom: 12px;">المواضيع الرئيسية</div>
                                    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 5px;">
                                        ${subject.topics.map(topic => `
                                            <span style="background: rgba(93, 95, 239, 0.1); color: var(--primary-color); padding: 10px 18px; border-radius: 20px; font-size: 14px; font-weight: 700;">
                                                ${topic}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: var(--secondary-color); margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid rgba(108, 99, 255, 0.1); font-weight: 800;">
                                <i class="fas fa-calendar-alt"></i> جدول المحاضرات
                            </h4>
                            
                            <div style="display: grid; gap: 18px;">
                                ${subject.schedule.map(session => `
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 18px; background: rgba(76, 201, 240, 0.05); border-radius: var(--radius-md); border-right: 4px solid var(--success-color);">
                                        <div>
                                            <div style="font-weight: 800; color: var(--text-primary); font-size: 16px;">${session.day}</div>
                                            <div style="color: var(--text-secondary); font-size: 14px;">${session.classroom}</div>
                                        </div>
                                        <span style="background: rgba(255, 107, 107, 0.1); color: var(--warning-color); padding: 10px 18px; border-radius: 20px; font-weight: 800;">
                                            ${session.time}
                                        </span>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <h4 style="color: var(--secondary-color); margin: 30px 0 20px; padding-bottom: 15px; border-bottom: 2px solid rgba(108, 99, 255, 0.1); font-weight: 800;">
                                <i class="fas fa-users"></i> المجموعات الدراسية
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 12px;">
                                ${subject.groups.map(group => `
                                    <div style="background: rgba(93, 95, 239, 0.1); padding: 15px 22px; border-radius: var(--radius-md); flex: 1; min-width: 140px; text-align: center; border: 2px solid rgba(93, 95, 239, 0.2);">
                                        <div style="font-size: 22px; font-weight: 900; color: var(--primary-color);">${group}</div>
                                        <div style="font-size: 13px; color: var(--text-secondary); font-weight: 600;">مجموعة</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 18px; justify-content: center; margin-top: 35px; flex-wrap: wrap;">
                        <button class="btn btn-success" onclick="navigateTo('createExam')">
                            <i class="fas fa-plus-circle"></i> إنشاء اختبار جديد
                        </button>
                        <button class="btn btn-primary" onclick="navigateTo('myExams')">
                            <i class="fas fa-clipboard-list"></i> عرض اختبارات المادة
                        </button>
                        <button class="btn btn-warning" onclick="editSubject(${subject.id})">
                            <i class="fas fa-edit"></i> تعديل المادة
                        </button>
                    </div>
                </div>
            `;
        }

        // تعديل بيانات الملف الشخصي (تبسيط عبر نوافذ حوار)
        function editProfile() {
            const newName = prompt('الاسم الكامل:', currentUser.name || '');
            if (newName) currentUser.name = newName;
            const newEmail = prompt('البريد الإلكتروني:', currentUser.email || '');
            if (newEmail) currentUser.email = newEmail;
            const newId = prompt('الرقم الجامعي:', currentUser.id || '');
            if (newId) currentUser.id = newId;
            const newPhone = prompt('الهاتف:', (currentUser.phone || ''));
            if (newPhone) currentUser.phone = newPhone;
            // حفظ التغييرات
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            // إعادة تحميل المحتوى وتحديث الرأس
            document.getElementById('loggedInUserName').textContent = currentUser.name;
            const nameParts = currentUser.name.split(' ');
            const initials = nameParts.length > 1 ? (nameParts[0].charAt(0) + nameParts[1].charAt(0)) : nameParts[0].charAt(0);
            document.getElementById('userAvatar').textContent = initials;
            loadDashboardContent();
        }

        // تحميل الصفحة الرئيسية للوحة التحكم
        function loadDashboardHome() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            if (currentUser.type === 'admin') {
                dashboardContent.innerHTML = `
                    <div class="welcome-message">
                        <h3>مرحباً ${currentUser.name} 👋</h3>
                        <p>نظام SmartExam يمنحك التحكم الكامل في إدارة الاختبارات الإلكترونية والمستخدمين</p>
                    </div>
                    
                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-icon admin">
                                <i class="fas fa-university"></i>
                            </div>
                            <h3>${sampleData.universities.length}</h3>
                            <p>جامعة</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon student">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                            <h3>${sampleData.students.length}</h3>
                            <p>طالب</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon teacher">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <h3>5</h3>
                            <p>مدرس</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-clipboard-list"></i>
                            </div>
                            <h3>${sampleExams.length}</h3>
                            <p>اختبار</p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">آخر الاختبارات المضافة</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>اسم الاختبار</th>
                                        <th>المادة</th>
                                        <th>المدرس</th>
                                        <th>المجموعة</th>
                                        <th>تاريخ البدء</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${sampleExams.slice(0, 3).map(exam => `
                                        <tr>
                                            <td><strong style="color:var(--secondary-color);">${exam.title}</strong></td>
                                            <td>${exam.subject}</td>
                                            <td>${exam.teacher}</td>
                                            <td>${exam.group}</td>
                                            <td>${new Date(exam.startTime).toLocaleDateString('ar-SA')}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">إحصائيات سريعة</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px;">
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="feature-content">
                                    <h4>التخصصات</h4>
                                    <p>${sampleData.majors.slice(0, 3).map(major => `${major.name} (${major.department})`).join('، ')}</p>
                                </div>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="feature-content">
                                    <h4>المجموعات</h4>
                                    <p>${sampleData.groups.slice(0, 3).map(group => `${group.name} - ${group.subject}`).join('، ')}</p>
                                </div>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="feature-content">
                                    <h4>المواد الدراسية</h4>
                                    <p>${sampleData.subjects.slice(0, 3).map(subject => `${subject.name} (${subject.code})`).join('، ')}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentUser.type === 'teacher') {
                dashboardContent.innerHTML = `
                    <div class="welcome-message">
                        <h3>مرحباً ${currentUser.name} 👋</h3>
                        <p>نظام SmartExam يساعدك في إنشاء وإدارة الاختبارات الإلكترونية البرمجية بسهولة</p>
                    </div>
                    
                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-icon teacher">
                                <i class="fas fa-laptop-code"></i>
                            </div>
                            <h3>${teacherSubjects.length}</h3>
                            <p>مادة برمجية</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3>${sampleData.groups.filter(g => g.teacher === currentUser.name).length}</h3>
                            <p>مجموعة</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon student">
                                <i class="fas fa-clipboard-list"></i>
                            </div>
                            <h3>${sampleExams.filter(e => e.teacher === currentUser.name).length}</h3>
                            <p>اختبار</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon admin">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3>${Math.round(teacherSubjects.reduce((total, subject) => total + subject.averageScore, 0) / teacherSubjects.length)}%</h3>
                            <p>متوسط النجاح</p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">اختباراتي الأخيرة</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>اسم الاختبار</th>
                                        <th>المادة</th>
                                        <th>المجموعة</th>
                                        <th>تاريخ البدء</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${sampleExams.filter(e => e.teacher === currentUser.name).map(exam => `
                                        <tr>
                                            <td><strong style="color:var(--secondary-color);">${exam.title}</strong></td>
                                            <td>${exam.subject}</td>
                                            <td>${exam.group}</td>
                                            <td>${new Date(exam.startTime).toLocaleDateString('ar-SA')}</td>
                                            <td class="actions">
                                                <button class="action-btn btn-primary" onclick="viewExamResults(${exam.id})">
                                                    <i class="fas fa-chart-bar"></i> النتائج
                                                </button>
                                                <button class="action-btn btn-warning">
                                                    <i class="fas fa-edit"></i> تعديل
                                                </button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">موادي البرمجية</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; margin-top: 25px;">
                            ${teacherSubjects.slice(0, 4).map(subject => `
                                <div class="info-card">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                                        <h4 style="color: var(--secondary-color); font-weight: 800;">${subject.name}</h4>
                                        <span class="badge badge-primary" style="padding: 5px 12px; font-size: 13px;">
                                            ${subject.code}
                                        </span>
                                    </div>
                                    <p style="color: var(--text-secondary); font-size: 15px; margin-bottom: 20px; line-height: 1.6;">${subject.description.substring(0, 90)}...</p>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span style="font-size: 13px; color: var(--text-secondary); font-weight: 600;">
                                            <i class="fas fa-users"></i> ${subject.studentsCount} طالب
                                        </span>
                                        <button class="btn btn-primary btn-sm" onclick="viewSubjectDetails(${subject.id})" style="padding: 10px 18px;">
                                            <i class="fas fa-eye"></i> عرض
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else if (currentUser.type === 'student') {
                dashboardContent.innerHTML = `
                    <div class="welcome-message">
                        <h3>مرحباً ${currentUser.name} 👋</h3>
                        <p>نظام SmartExam يساعدك في أداء الاختبارات الإلكترونية ومتابعة نتائجك</p>
                    </div>
                    
                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-icon student">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <h3>2</h3>
                            <p>اختبار متاح</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-award"></i>
                            </div>
                            <h3>85%</h3>
                            <p>متوسط درجاتك</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon teacher">
                                <i class="fas fa-book"></i>
                            </div>
                            <h3>5</h3>
                            <p>مادة</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon admin">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3>${sampleData.groups.filter(g => g.name === sampleData.students.find(s => s.id === currentUser.id)?.group).length}</h3>
                            <p>مجموعة</p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">اختباراتي القادمة</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>اسم الاختبار</th>
                                        <th>المادة</th>
                                        <th>المدرس</th>
                                        <th>تاريخ البدء</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${sampleExams.slice(0, 2).map(exam => `
                                        <tr>
                                            <td><strong style="color:var(--secondary-color);">${exam.title}</strong></td>
                                            <td>${exam.subject}</td>
                                            <td>${exam.teacher}</td>
                                            <td>${new Date(exam.startTime).toLocaleDateString('ar-SA')}</td>
                                            <td>
                                                <button class="btn btn-primary" onclick="startExam(${exam.id})" style="padding: 12px 25px;">
                                                    <i class="fas fa-play-circle"></i> بدء الاختبار
                                                </button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">آخر النتائج</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>اسم الاختبار</th>
                                        <th>المادة</th>
                                        <th>الدرجة</th>
                                        <th>النسبة</th>
                                        <th>التاريخ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong style="color:var(--secondary-color);">اختبار برمجة الويب النصفي</strong></td>
                                        <td>برمجة الويب</td>
                                        <td>18/20</td>
                                        <td><span class="badge badge-success" style="padding: 8px 15px; font-weight: 700;">90%</span></td>
                                        <td>2024-11-15</td>
                                    </tr>
                                    <tr>
                                        <td><strong style="color:var(--secondary-color);">اختبار قواعد البيانات</strong></td>
                                        <td>قواعد البيانات</td>
                                        <td>15/20</td>
                                        <td><span class="badge badge-warning" style="padding: 8px 15px; font-weight: 700;">75%</span></td>
                                        <td>2024-11-10</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            }
        }

        // تحميل إدارة الطلاب (للمدير)
        function loadStudentsManagement() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>إدارة الطلاب</h2>
                    <div>
                        <button class="btn btn-success" onclick="addNewStudent()">
                            <i class="fas fa-plus"></i> إضافة طالب جديد
                        </button>
                        <button class="btn btn-primary" style="margin-right: 12px;">
                            <i class="fas fa-file-export"></i> استيراد من Excel
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; gap: 12px;">
                            <input type="text" id="searchStudent" placeholder="بحث عن طالب..." style="padding: 14px; flex: 1; border-radius: var(--radius-md); border: 2px solid rgba(108, 99, 255, 0.2); font-size: 15px;">
                            <button class="btn btn-primary" style="padding: 14px 25px;">
                                <i class="fas fa-search"></i> بحث
                            </button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>الرقم</th>
                                    <th>اسم الطالب</th>
                                    <th>البريد الإلكتروني</th>
                                    <th>التخصص</th>
                                    <th>المستوى</th>
                                    <th>المجموعة</th>
                                    <th>المعدل</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sampleData.students.map(student => `
                                    <tr>
                                        <td>${student.id}</td>
                                        <td><strong style="color:var(--secondary-color);">${student.name}</strong></td>
                                        <td>${student.email}</td>
                                        <td><span class="badge badge-primary" style="padding: 8px 15px;">${student.major}</span></td>
                                        <td>${student.level}</td>
                                        <td>${student.group}</td>
                                        <td><strong style="color:var(--primary-color);">${student.gpa}</strong></td>
                                        <td class="actions">
                                            <button class="action-btn btn-primary">
                                                <i class="fas fa-eye"></i> عرض
                                            </button>
                                            <button class="action-btn btn-warning">
                                                <i class="fas fa-edit"></i> تعديل
                                            </button>
                                            <button class="action-btn btn-danger">
                                                <i class="fas fa-trash"></i> حذف
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // تحميل إدارة المواد (للمدير)
        function loadSubjectsManagement() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>إدارة المواد الدراسية</h2>
                    <button class="btn btn-success" onclick="addNewSubject()">
                        <i class="fas fa-plus"></i> إضافة مادة جديدة
                    </button>
                </div>
                
                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>الرقم</th>
                                    <th>اسم المادة</th>
                                    <th>الكود</th>
                                    <th>الساعات المعتمدة</th>
                                    <th>القسم</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sampleData.subjects.map(subject => `
                                    <tr>
                                        <td>${subject.id}</td>
                                        <td><strong style="color:var(--secondary-color);">${subject.name}</strong></td>
                                        <td><span class="badge badge-success" style="padding: 8px 15px;">${subject.code}</span></td>
                                        <td>${subject.credits}</td>
                                        <td>${subject.department}</td>
                                        <td class="actions">
                                            <button class="action-btn btn-primary">
                                                <i class="fas fa-eye"></i> عرض
                                            </button>
                                            <button class="action-btn btn-warning">
                                                <i class="fas fa-edit"></i> تعديل
                                            </button>
                                            <button class="action-btn btn-danger">
                                                <i class="fas fa-trash"></i> حذف
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // تحميل إدارة المجموعات (للمدير)
        function loadGroupsManagement() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>إدارة المجموعات الطلابية</h2>
                    <button class="btn btn-success" onclick="addNewGroup()">
                        <i class="fas fa-plus"></i> إضافة مجموعة جديدة
                    </button>
                </div>
                
                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>الرقم</th>
                                    <th>اسم المجموعة</th>
                                    <th>المادة</th>
                                    <th>المدرس</th>
                                    <th>عدد الطلاب</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sampleData.groups.map(group => `
                                    <tr>
                                        <td>${group.id}</td>
                                        <td><strong style="color:var(--secondary-color);">${group.name}</strong></td>
                                        <td>${group.subject}</td>
                                        <td>${group.teacher}</td>
                                        <td><span class="badge badge-warning" style="padding: 8px 15px;">${group.studentsCount}</span></td>
                                        <td class="actions">
                                            <button class="action-btn btn-primary">
                                                <i class="fas fa-users"></i> عرض الطلاب
                                            </button>
                                            <button class="action-btn btn-warning">
                                                <i class="fas fa-edit"></i> تعديل
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // تحميل الاختبارات المتاحة (للطالب)
        function loadAvailableExams() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>الاختبارات المتاحة</h2>
                </div>
                
                <div class="card">
                    <h3 class="card-title">الاختبارات المتاحة حالياً</h3>
                    <p style="color: var(--text-secondary); font-size: 16px; margin-bottom: 30px;">فيما يلي قائمة بالاختبارات المتاحة لك حالياً:</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 30px; margin-top: 30px;">
                        ${sampleExams.map(exam => `
                            <div class="info-card">
                                <h3 style="color: var(--secondary-color); margin-bottom: 20px; font-weight: 800;">${exam.title}</h3>
                                <div style="display: grid; gap: 12px;">
                                    <p><i class="fas fa-laptop-code" style="color: var(--primary-color);"></i> <strong>المادة:</strong> ${exam.subject}</p>
                                    <p><i class="fas fa-chalkboard-teacher" style="color: var(--teacher-color);"></i> <strong>المدرس:</strong> ${exam.teacher}</p>
                                    <p><i class="fas fa-clock" style="color: var(--warning-color);"></i> <strong>المدة:</strong> ${exam.duration} دقيقة</p>
                                    <p><i class="fas fa-calendar-alt" style="color: var(--success-color);"></i> <strong>وقت البدء:</strong> ${new Date(exam.startTime).toLocaleString('ar-SA')}</p>
                                    <p><i class="fas fa-calendar-times" style="color: var(--danger-color);"></i> <strong>وقت الانتهاء:</strong> ${new Date(exam.endTime).toLocaleString('ar-SA')}</p>
                                </div>
                                
                                <div style="margin-top: 25px;">
                                    <button class="btn btn-primary" style="width: 100%; padding: 15px;" onclick="startExam(${exam.id})">
                                        <i class="fas fa-play-circle"></i> بدء الاختبار
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // تحميل نتائج الطالب
        function loadStudentResults() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>نتائجي</h2>
                </div>
                
                <div class="card">
                    <h3 class="card-title">سجل النتائج</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>اسم الاختبار</th>
                                    <th>المادة</th>
                                    <th>الدرجة</th>
                                    <th>النسبة</th>
                                    <th>التاريخ</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong style="color:var(--secondary-color);">اختبار برمجة الويب النصفي</strong></td>
                                    <td>برمجة الويب</td>
                                    <td>18/20</td>
                                    <td><span class="badge badge-success" style="padding: 8px 15px; font-weight: 700;">90%</span></td>
                                    <td>2024-11-15</td>
                                    <td>
                                        <button class="btn btn-primary btn-sm" onclick="viewResultDetails(1)" style="padding: 10px 18px;">
                                            <i class="fas fa-eye"></i> عرض التفاصيل
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong style="color:var(--secondary-color);">اختبار قواعد البيانات</strong></td>
                                    <td>قواعد البيانات</td>
                                    <td>15/20</td>
                                    <td><span class="badge badge-warning" style="padding: 8px 15px; font-weight: 700;">75%</span></td>
                                    <td>2024-11-10</td>
                                    <td>
                                        <button class="btn btn-primary btn-sm" onclick="viewResultDetails(2)" style="padding: 10px 18px;">
                                            <i class="fas fa-eye"></i> عرض التفاصيل
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong style="color:var(--secondary-color);">اختبار هياكل البيانات العملي</strong></td>
                                    <td>هياكل البيانات</td>
                                    <td>22/25</td>
                                    <td><span class="badge badge-success" style="padding: 8px 15px; font-weight: 700;">88%</span></td>
                                    <td>2024-10-28</td>
                                    <td>
                                        <button class="btn btn-primary btn-sm" onclick="viewResultDetails(3)" style="padding: 10px 18px;">
                                            <i class="fas fa-eye"></i> عرض التفاصيل
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">إحصائيات أدائي</h3>
                    <div style="display: flex; justify-content: space-around; flex-wrap: wrap; text-align: center; gap: 25px; margin-top: 20px;">
                        <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(76, 201, 240, 0.1), rgba(76, 201, 240, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(76, 201, 240, 0.1);">
                            <div class="stat-icon success" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--success-color);">85%</div>
                            <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">متوسط النجاح</div>
                        </div>
                        <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(93, 95, 239, 0.1), rgba(93, 95, 239, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(93, 95, 239, 0.1);">
                            <div class="stat-icon primary" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                                <i class="fas fa-clipboard-list"></i>
                            </div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--primary-color);">12</div>
                            <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">عدد الاختبارات</div>
                        </div>
                        <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(255, 107, 107, 0.1);">
                            <div class="stat-icon warning" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                                <i class="fas fa-star"></i>
                            </div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--warning-color);">3.7</div>
                            <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">المعدل التراكمي</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // تحميل اختبارات المدرس
        function loadTeacherExams() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>اختباراتي</h2>
                    <button class="btn btn-success" onclick="navigateTo('createExam')">
                        <i class="fas fa-plus"></i> إنشاء اختبار جديد
                    </button>
                </div>
                
                <div class="card">
                    <h3 class="card-title">قائمة الاختبارات</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>اسم الاختبار</th>
                                    <th>المادة</th>
                                    <th>المجموعة</th>
                                    <th>عدد الأسئلة</th>
                                    <th>تاريخ البدء</th>
                                    <th>حالة الاختبار</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sampleExams.filter(e => e.teacher === currentUser.name).map(exam => `
                                    <tr>
                                        <td><strong style="color:var(--secondary-color);">${exam.title}</strong></td>
                                        <td>${exam.subject}</td>
                                        <td>${exam.group}</td>
                                        <td>${exam.questions.length}</td>
                                        <td>${new Date(exam.startTime).toLocaleDateString('ar-SA')}</td>
                                        <td>
                                            <span class="badge ${new Date() < new Date(exam.endTime) ? 'badge-success' : 'badge-warning'}" style="padding: 10px 18px; font-weight: 700;">
                                                ${new Date() < new Date(exam.endTime) ? 'نشط' : 'منتهي'}
                                            </span>
                                        </td>
                                        <td class="actions">
                                            <button class="action-btn btn-primary" onclick="viewExamResults(${exam.id})">
                                                <i class="fas fa-chart-bar"></i> النتائج
                                            </button>
                                            <button class="action-btn btn-warning">
                                                <i class="fas fa-edit"></i> تعديل
                                            </button>
                                            <button class="action-btn btn-danger">
                                                <i class="fas fa-trash"></i> حذف
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // تحميل نتائج الطلاب للمدرس
        function loadTeacherResults() {
            const dashboardContent = document.getElementById('dashboardContent');
            
            dashboardContent.innerHTML = `
                <div class="page-title">
                    <h2>نتائج الطلاب</h2>
                </div>
                
                <div class="card">
                    <h3 class="card-title">عرض نتائج الاختبارات</h3>
                    <div style="margin-bottom: 30px; display: flex; gap: 18px; align-items: center; flex-wrap: wrap;">
                        <select id="examSelect" style="padding: 14px; flex: 1; min-width: 260px; border-radius: var(--radius-md); border: 2px solid rgba(108, 99, 255, 0.2); font-size: 15px;">
                            <option value="">اختر اختبار لعرض النتائج</option>
                            ${sampleExams.filter(e => e.teacher === currentUser.name).map(exam => `
                                <option value="${exam.id}">${exam.title}</option>
                            `).join('')}
                        </select>
                        <button class="btn btn-primary" onclick="loadExamResults()" style="padding: 14px 25px;">
                            <i class="fas fa-eye"></i> عرض النتائج
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>اسم الطالب</th>
                                    <th>البريد الإلكتروني</th>
                                    <th>المجموعة</th>
                                    <th>الدرجة</th>
                                    <th>النسبة</th>
                                    <th>حالة النجاح</th>
                                    <th>التاريخ</th>
                                </tr>
                            </thead>
                            <tbody id="examResultsTable">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">
                                        <i class="fas fa-search" style="font-size: 50px; color: rgba(108, 99, 255, 0.3); margin-bottom: 20px; display: block;"></i>
                                        <h4 style="color: var(--text-secondary); font-weight: 600;">اختر اختباراً لعرض النتائج</h4>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">إحصائيات الاختبار</h3>
                    <div id="examStats" style="display: flex; justify-content: space-around; flex-wrap: wrap; text-align: center; gap: 25px; margin-top: 20px;">
                        <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(93, 95, 239, 0.1), rgba(93, 95, 239, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(93, 95, 239, 0.1);">
                            <div class="stat-icon primary" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                                <i class="fas fa-users"></i>
                            </div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--primary-color);">0</div>
                            <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">عدد الطلاب</div>
                        </div>
                        <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(76, 201, 240, 0.1), rgba(76, 201, 240, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(76, 201, 240, 0.1);">
                            <div class="stat-icon success" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--success-color);">0%</div>
                            <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">متوسط النجاح</div>
                        </div>
                        <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(255, 107, 107, 0.1);">
                            <div class="stat-icon warning" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--warning-color);">0</div>
                            <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">أعلى درجة</div>
                        </div>
                        <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(114, 9, 183, 0.1), rgba(114, 9, 183, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(114, 9, 183, 0.1);">
                            <div class="stat-icon danger" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                                <i class="fas fa-chart-area"></i>
                            </div>
                            <div style="font-size: 38px; font-weight: 900; color: var(--danger-color);">0</div>
                            <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">أقل درجة</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // عرض نتائج اختبار معين
        function loadExamResults() {
            const examId = document.getElementById('examSelect').value;
            if (!examId) return;
            
            const exam = sampleExams.find(e => e.id == examId);
            if (!exam) return;
            
            // محاكاة بيانات النتائج
            const mockResults = [
                { studentName: 'برهان الزمر', email: 'student@smartschool.edu', group: exam.group, score: 18, total: exam.totalScore, date: exam.startTime },
                { studentName: 'محمد قريع', email: 'ali@smartschool.edu', group: exam.group, score: 15, total: exam.totalScore, date: exam.startTime },
                { studentName: 'مازن أبو راس', email: 'fatima@smartschool.edu', group: exam.group, score: 12, total: exam.totalScore, date: exam.startTime },
                { studentName: 'أحمد سعيد', email: 'ahmed@smartschool.edu', group: exam.group, score: 20, total: exam.totalScore, date: exam.startTime },
                { studentName: 'سارة محمد', email: 'sara@smartschool.edu', group: exam.group, score: 14, total: exam.totalScore, date: exam.startTime }
            ];
            
            // تحديث جدول النتائج
            const resultsTable = document.getElementById('examResultsTable');
            resultsTable.innerHTML = mockResults.map(result => `
                <tr>
                    <td><strong style="color:var(--secondary-color);">${result.studentName}</strong></td>
                    <td>${result.email}</td>
                    <td>${result.group}</td>
                    <td><strong style="color:var(--primary-color);font-size:16px;">${result.score}/${result.total}</strong></td>
                    <td>
                        <span class="badge ${result.score / result.total >= 0.5 ? 'badge-success' : 'badge-warning'}" style="padding: 10px 18px; font-weight: 700;">
                            ${Math.round((result.score / result.total) * 100)}%
                        </span>
                    </td>
                    <td>
                        <span class="badge ${result.score / result.total >= 0.5 ? 'badge-success' : 'badge-warning'}" style="padding: 10px 18px; font-weight: 700;">
                            ${result.score / result.total >= 0.5 ? 'ناجح' : 'راسب'}
                        </span>
                    </td>
                    <td>${new Date(result.date).toLocaleDateString('ar-SA')}</td>
                </tr>
            `).join('');
            
            // تحديث الإحصائيات
            const totalStudents = mockResults.length;
            const averageScore = mockResults.reduce((sum, result) => sum + (result.score / result.total * 100), 0) / totalStudents;
            const maxScore = Math.max(...mockResults.map(r => r.score));
            const minScore = Math.min(...mockResults.map(r => r.score));
            
            document.getElementById('examStats').innerHTML = `
                <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(93, 95, 239, 0.1), rgba(93, 95, 239, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(93, 95, 239, 0.1);">
                    <div class="stat-icon primary" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                        <i class="fas fa-users"></i>
                    </div>
                    <div style="font-size: 38px; font-weight: 900; color: var(--primary-color);">${totalStudents}</div>
                    <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">عدد الطلاب</div>
                </div>
                <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(76, 201, 240, 0.1), rgba(76, 201, 240, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(76, 201, 240, 0.1);">
                    <div class="stat-icon success" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div style="font-size: 38px; font-weight: 900; color: var(--success-color);">${Math.round(averageScore)}%</div>
                    <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">متوسط النجاح</div>
                </div>
                <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(255, 107, 107, 0.1);">
                    <div class="stat-icon warning" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div style="font-size: 38px; font-weight: 900; color: var(--warning-color);">${maxScore}/${exam.totalScore}</div>
                    <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">أعلى درجة</div>
                </div>
                <div style="flex: 1; min-width: 170px; padding: 25px; background: linear-gradient(135deg, rgba(114, 9, 183, 0.1), rgba(114, 9, 183, 0.05)); border-radius: var(--radius-lg); border: 1px solid rgba(114, 9, 183, 0.1);">
                    <div class="stat-icon danger" style="width: 70px; height: 70px; margin: 0 auto 20px;">
                        <i class="fas fa-chart-area"></i>
                    </div>
                    <div style="font-size: 38px; font-weight: 900; color: var(--danger-color);">${minScore}/${exam.totalScore}</div>
                    <div style="color: var(--text-secondary); font-weight: 600; margin-top: 8px;">أقل درجة</div>
                </div>
            `;
        }

        // عرض نتائج الاختبار
        function viewExamResults(examId) {
            // الانتقال إلى صفحة نتائج المدرس ثم تحميل نتائج الاختبار المحدد
            navigateTo('results');
            setTimeout(() => {
                const select = document.getElementById('examSelect');
                if (select) {
                    select.value = examId;
                    loadExamResults();
                    const table = document.getElementById('examResultsTable');
                    if (table) table.scrollIntoView({ behavior: 'smooth' });
                } else {
                    alert('تعذر تحميل واجهة النتائج حالياً. حاول مرة أخرى.');
                }
            }, 80);
        }

        // عرض تفاصيل النتيجة
        function viewResultDetails(resultId) {
            alert(`عرض تفاصيل النتيجة رقم ${resultId} - هذه الميزة قيد التطوير`);
        }

        // بدء الاختبار
        function startExam(examId) {
            currentExam = sampleExams.find(e => e.id == examId);
            if (!currentExam) return;
            
            examTimeLeft = currentExam.duration * 60; // تحويل الدقائق إلى ثواني
            examAnswers = {};
            currentQuestionIndex = 0;
            
            // الانتقال إلى شاشة الاختبار
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('examScreen').style.display = 'block';
            
            loadExamQuestion();
            startExamTimer();
        }

        // تحميل سؤال الاختبار الحالي
        function loadExamQuestion() {
            const examContent = document.getElementById('examContent');
            const question = currentExam.questions[currentQuestionIndex];
            
            if (!question) return;
            
            let optionsHtml = '';
            
            if (question.type === 'mcq') {
                optionsHtml = question.options.map((option, index) => `
                    <div class="option ${examAnswers[question.id] === index ? 'selected' : ''}" onclick="selectAnswer(${question.id}, ${index})">
                        <input type="radio" name="q${question.id}" ${examAnswers[question.id] === index ? 'checked' : ''}>
                        ${option}
                    </div>
                `).join('');
            } else if (question.type === 'truefalse') {
                optionsHtml = `
                    <div class="option ${examAnswers[question.id] === true ? 'selected' : ''}" onclick="selectAnswer(${question.id}, true)">
                        <input type="radio" name="q${question.id}" ${examAnswers[question.id] === true ? 'checked' : ''}>
                        صح
                    </div>
                    <div class="option ${examAnswers[question.id] === false ? 'selected' : ''}" onclick="selectAnswer(${question.id}, false)">
                        <input type="radio" name="q${question.id}" ${examAnswers[question.id] === false ? 'checked' : ''}>
                        خطأ
                    </div>
                `;
            } else if (question.type === 'essay') {
                optionsHtml = `
                    <textarea id="essayAnswer${question.id}" style="width: 100%; height: 180px; padding: 20px; border-radius: var(--radius-md); border: 2px solid rgba(108, 99, 255, 0.2); font-size: 16px; resize: vertical;" 
                    oninput="saveEssayAnswer(${question.id}, this.value)" placeholder="أكتب إجابتك هنا...">${examAnswers[question.id] || ''}</textarea>
                `;
            }
            
            // إنشاء أزرار التنقل بين الأسئلة
            const navButtons = currentExam.questions.map((q, index) => `
                <button class="question-nav-btn ${index === currentQuestionIndex ? 'active' : ''} ${examAnswers[q.id] !== undefined ? 'answered' : ''}" 
                onclick="goToQuestion(${index})">${index + 1}</button>
            `).join('');
            
            examContent.innerHTML = `
                <div class="exam-header">
                    <h2 style="color:var(--secondary-color);">${currentExam.title}</h2>
                    <div class="timer" id="examTimer">${formatTime(examTimeLeft)}</div>
                </div>
                
                <div class="question-navigation">
                    ${navButtons}
                </div>
                
                <div class="question-card card">
                    <div class="question-text">
                        <strong>السؤال ${currentQuestionIndex + 1} من ${currentExam.questions.length}:</strong><br>
                        ${question.text}
                    </div>
                    
                    <div class="options-container">
                        ${optionsHtml}
                    </div>
                </div>
                
                <div class="exam-actions">
                    <button class="btn btn-primary" ${currentQuestionIndex === 0 ? 'disabled' : ''} onclick="prevQuestion()" style="padding: 15px 30px;">
                        <i class="fas fa-arrow-right"></i> السابق
                    </button>
                    
                    <button class="btn btn-success" onclick="submitExam()" style="padding: 15px 30px;">
                        <i class="fas fa-check-circle"></i> تسليم الاختبار
                    </button>
                    
                    <button class="btn btn-primary" ${currentQuestionIndex === currentExam.questions.length - 1 ? 'disabled' : ''} onclick="nextQuestion()" style="padding: 15px 30px;">
                        <i class="fas fa-arrow-left"></i> التالي
                    </button>
                </div>
            `;
        }

        // تحديد إجابة
        function selectAnswer(questionId, answer) {
            examAnswers[questionId] = answer;
            loadExamQuestion(); // إعادة تحميل السؤال لتحديث الواجهة
        }

        // حفظ إجابة مقالية
        function saveEssayAnswer(questionId, answer) {
            examAnswers[questionId] = answer;
        }

        // الانتقال إلى سؤال معين
        function goToQuestion(index) {
            currentQuestionIndex = index;
            loadExamQuestion();
        }

        // السؤال السابق
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadExamQuestion();
            }
        }

        // السؤال التالي
        function nextQuestion() {
            if (currentQuestionIndex < currentExam.questions.length - 1) {
                currentQuestionIndex++;
                loadExamQuestion();
            }
        }

        // بدء مؤقت الاختبار
        function startExamTimer() {
            if (examTimer) clearInterval(examTimer);
            
            examTimer = setInterval(() => {
                examTimeLeft--;
                document.getElementById('examTimer').textContent = formatTime(examTimeLeft);
                
                // تحذير عند اقتراب انتهاء الوقت
                if (examTimeLeft === 300) { // 5 دقائق
                    document.getElementById('examTimer').classList.add('warning');
                    alert('تنبيه: بقي 5 دقائق فقط على انتهاء وقت الاختبار!');
                }
                
                // انتهاء الوقت تلقائياً
                if (examTimeLeft <= 0) {
                    clearInterval(examTimer);
                    submitExam();
                }
            }, 1000);
        }

        // تنسيق الوقت
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // تسليم الاختبار
        function submitExam() {
            if (examTimer) clearInterval(examTimer);
            
            // حساب النتيجة
            let score = 0;
            let total = 0;
            
            currentExam.questions.forEach(question => {
                if (question.type === 'mcq' || question.type === 'truefalse') {
                    total++;
                    if (examAnswers[question.id] === question.correctAnswer) {
                        score++;
                    }
                } else if (question.type === 'essay') {
                    total += question.maxScore || 5;
                    // للمقالية، نعطي درجة عشوائية للتجربة
                    score += examAnswers[question.id] ? Math.floor(Math.random() * (question.maxScore || 5)) + 1 : 0;
                }
            });
            
            // عرض شاشة النتائج
            showResults(score, total);
        }

        // عرض النتائج
        function showResults(score, total) {
            document.getElementById('examScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';
            
            const percentage = Math.round((score / total) * 100);
            let resultIcon = 'success';
            let resultMessage = '';
            
            if (percentage >= 85) {
                resultIcon = 'success';
                resultMessage = 'ممتاز! لقد حققت نتيجة رائعة.';
            } else if (percentage >= 70) {
                resultIcon = 'success';
                resultMessage = 'جيد جداً! لقد اجتزت الاختبار بنجاح.';
            } else if (percentage >= 50) {
                resultIcon = 'warning';
                resultMessage = 'مقبول. يمكنك التحسين في المرات القادمة.';
            } else {
                resultIcon = 'danger';
                resultMessage = 'يجب عليك الدراسة أكثر للمرة القادمة.';
            }
            
            // إنشاء مراجعة للإجابات
            let answersReview = '';
            currentExam.questions.forEach((question, index) => {
                const userAnswer = examAnswers[question.id];
                let correctAnswerText = '';
                let userAnswerText = '';
                let isCorrect = false;
                
                if (question.type === 'mcq') {
                    correctAnswerText = question.options[question.correctAnswer];
                    userAnswerText = userAnswer !== undefined ? question.options[userAnswer] : 'لم تتم الإجابة';
                    isCorrect = userAnswer === question.correctAnswer;
                } else if (question.type === 'truefalse') {
                    correctAnswerText = question.correctAnswer ? 'صح' : 'خطأ';
                    userAnswerText = userAnswer !== undefined ? (userAnswer ? 'صح' : 'خطأ') : 'لم تتم الإجابة';
                    isCorrect = userAnswer === question.correctAnswer;
                } else if (question.type === 'essay') {
                    correctAnswerText = 'إجابة مقالية (يتم تقييمها من قبل المدرس)';
                    userAnswerText = userAnswer || 'لم تتم الإجابة';
                    isCorrect = true; // نعتبرها صحيحة مؤقتاً
                }
                
                answersReview += `
                    <div class="answer-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <p style="font-weight: 700; color: var(--text-primary); margin-bottom: 10px;">السؤال ${index + 1}: ${question.text}</p>
                        <p><strong>إجابتك:</strong> ${userAnswerText}</p>
                        ${!isCorrect ? `<p><strong>الإجابة الصحيحة:</strong> ${correctAnswerText}</p>` : ''}
                    </div>
                `;
            });
            
            document.getElementById('resultContent').innerHTML = `
                <div class="result-card card">
                    <div class="result-icon ${resultIcon}">
                        <i class="fas fa-${resultIcon === 'success' ? 'trophy' : resultIcon === 'warning' ? 'exclamation-triangle' : 'times-circle'}"></i>
                    </div>
                    
                    <h2 style="color:var(--secondary-color);margin-bottom:15px;">${currentExam.title}</h2>
                    <p style="font-size:18px;color:var(--text-secondary);margin-bottom:30px;">${resultMessage}</p>
                    
                    <div class="score">${score}/${total}</div>
                    <div class="score-percentage">${percentage}%</div>
                    
                    <div style="margin-top: 40px; display: flex; gap: 18px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="goToDashboard()" style="padding: 15px 35px;">
                            <i class="fas fa-home"></i> العودة إلى لوحة التحكم
                        </button>
                        <button class="btn btn-success" onclick="reviewAnswers()" style="padding: 15px 35px;">
                            <i class="fas fa-eye"></i> مراجعة الإجابات
                        </button>
                    </div>
                </div>
                
                <div id="answersReview" class="answers-review" style="display: none;">
                    <h3 style="color:var(--secondary-color);margin-bottom:25px;font-weight:800;">مراجعة الإجابات</h3>
                    ${answersReview}
                </div>
            `;
        }

        // مراجعة الإجابات
        function reviewAnswers() {
            const reviewSection = document.getElementById('answersReview');
            if (reviewSection.style.display === 'none') {
                reviewSection.style.display = 'block';
                window.scrollTo(0, document.body.scrollHeight);
            } else {
                reviewSection.style.display = 'none';
            }
        }

        // الخروج من الاختبار
        function exitExam() {
            if (confirm('هل أنت متأكد من الخروج من الاختبار؟ سيتم فقدان إجاباتك.')) {
                if (examTimer) clearInterval(examTimer);
                goToDashboard();
            }
        }

        // العودة إلى لوحة التحكم
        function goToDashboard() {
            document.getElementById('examScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('createExamScreen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            // إعادة تعيين بيانات الاختبار
            currentExam = null;
            examAnswers = {};
            examTimeLeft = 0;
            currentQuestionIndex = 0;
            
            loadDashboardContent();
        }

        // عرض شاشة إنشاء اختبار
        function showCreateExamScreen() {
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('createExamScreen').style.display = 'block';
            
            document.getElementById('createExamContent').innerHTML = `
                <div class="page-title">
                    <h2>إنشاء اختبار جديد</h2>
                </div>
                
                <div class="card">
                    <form id="createExamForm">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                            <div class="form-group">
                                <label for="examTitle">عنوان الاختبار</label>
                                <input type="text" id="examTitle" placeholder="أدخل عنوان الاختبار" required style="padding: 16px; border-radius: var(--radius-md);">
                            </div>
                            
                            <div class="form-group">
                                <label for="examSubject">المادة</label>
                                <select id="examSubject" required style="padding: 16px; border-radius: var(--radius-md);">
                                    <option value="">اختر المادة</option>
                                    ${teacherSubjects.map(subject => `
                                        <option value="${subject.id}">${subject.name} (${subject.code})</option>
                                    `).join('')}
                                </select>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                            <div class="form-group">
                                <label for="examGroup">المجموعة المستهدفة</label>
                                <select id="examGroup" required style="padding: 16px; border-radius: var(--radius-md);">
                                    <option value="">اختر المجموعة</option>
                                    ${sampleData.groups.filter(g => g.teacher === currentUser.name).map(group => `
                                        <option value="${group.id}">${group.name} - ${group.subject}</option>
                                    `).join('')}
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="examDuration">مدة الاختبار (دقيقة)</label>
                                <input type="number" id="examDuration" min="5" max="180" value="45" required style="padding: 16px; border-radius: var(--radius-md);">
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                            <div class="form-group">
                                <label for="examStartTime">وقت البدء</label>
                                <input type="datetime-local" id="examStartTime" required style="padding: 16px; border-radius: var(--radius-md);">
                            </div>
                            
                            <div class="form-group">
                                <label for="examEndTime">وقت الانتهاء</label>
                                <input type="datetime-local" id="examEndTime" required style="padding: 16px; border-radius: var(--radius-md);">
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 35px;">
                            <label for="examDescription">وصف الاختبار (اختياري)</label>
                            <textarea id="examDescription" rows="3" placeholder="أدخل وصفاً للاختبار" style="padding: 16px; border-radius: var(--radius-md);"></textarea>
                        </div>
                        
                        <hr style="margin: 35px 0; border: 1px solid rgba(108, 99, 255, 0.1);">
                        
                        <h3 style="margin-bottom: 30px; color: var(--secondary-color); font-weight: 800;">أسئلة الاختبار</h3>
                        
                        <div id="questionsContainer">
                            <!-- سيتم إضافة الأسئلة هنا -->
                        </div>
                        
                        <div style="text-align: center; margin: 35px 0; display: flex; gap: 18px; justify-content: center; flex-wrap: wrap;">
                            <button type="button" class="btn btn-primary" onclick="addQuestion('mcq')" style="padding: 15px 25px;">
                                <i class="fas fa-plus-circle"></i> إضافة سؤال اختيار من متعدد
                            </button>
                            <button type="button" class="btn btn-warning" onclick="addQuestion('truefalse')" style="padding: 15px 25px;">
                                <i class="fas fa-plus-circle"></i> إضافة سؤال صح وخطأ
                            </button>
                            <button type="button" class="btn btn-success" onclick="addQuestion('essay')" style="padding: 15px 25px;">
                                <i class="fas fa-plus-circle"></i> إضافة سؤال مقالي
                            </button>
                        </div>
                        
                        <div style="text-align: center; margin-top: 45px;">
                            <button type="submit" class="btn btn-success" style="padding: 18px 55px;">
                                <i class="fas fa-save"></i> حفظ الاختبار
                            </button>
                            <button type="button" class="btn btn-danger" onclick="goToDashboard()" style="margin-right: 18px; padding: 18px 35px;">
                                <i class="fas fa-times"></i> إلغاء
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            // تعيين القيم الافتراضية للوقت
            const now = new Date();
            const startTime = new Date(now.getTime() + 24 * 60 * 60 * 1000); // غداً
            const endTime = new Date(startTime.getTime() + 7 * 24 * 60 * 60 * 1000); // بعد أسبوع
            
            document.getElementById('examStartTime').value = startTime.toISOString().slice(0, 16);
            document.getElementById('examEndTime').value = endTime.toISOString().slice(0, 16);
            
            // إضافة حدث للنموذج
            document.getElementById('createExamForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveExam();
            });
            
            // إضافة سؤالين كمثال
            addQuestion('mcq');
            addQuestion('truefalse');
        }

        // إضافة سؤال جديد
        function addQuestion(type) {
            const questionsContainer = document.getElementById('questionsContainer');
            const questionId = Date.now(); // معرف فريد للسؤال
            
            let questionHtml = '';
            
            if (type === 'mcq') {
                questionHtml = `
                    <div class="card question-item" id="question-${questionId}" style="margin-bottom: 30px; padding: 30px; border-left: 5px solid var(--primary-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                            <h4 style="color: var(--primary-color); font-weight: 800;"><i class="fas fa-list-ol"></i> سؤال اختيار من متعدد</h4>
                            <button type="button" class="btn btn-danger btn-sm" onclick="removeQuestion(${questionId})" style="padding: 10px 18px;">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 25px;">
                            <label>نص السؤال</label>
                            <input type="text" class="question-text" placeholder="أدخل نص السؤال" required style="padding: 16px; border-radius: var(--radius-md);">
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 25px;">
                            <label>الخيارات</label>
                            <div class="options-container" style="display: grid; gap: 18px;">
                                <div style="display: flex; align-items: center; gap: 18px; padding: 18px; background: rgba(93, 95, 239, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(93, 95, 239, 0.1);">
                                    <input type="text" class="option-text" placeholder="الخيار الأول" required style="flex: 1; padding: 14px; border-radius: var(--radius-sm); border: 1px solid rgba(108, 99, 255, 0.2);">
                                    <input type="radio" name="correct-${questionId}" value="0">
                                    <span style="color: var(--primary-color); font-weight: 600;">الإجابة الصحيحة</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 18px; padding: 18px; background: rgba(93, 95, 239, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(93, 95, 239, 0.1);">
                                    <input type="text" class="option-text" placeholder="الخيار الثاني" required style="flex: 1; padding: 14px; border-radius: var(--radius-sm); border: 1px solid rgba(108, 99, 255, 0.2);">
                                    <input type="radio" name="correct-${questionId}" value="1">
                                    <span style="color: var(--primary-color); font-weight: 600;">الإجابة الصحيحة</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 18px; padding: 18px; background: rgba(93, 95, 239, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(93, 95, 239, 0.1);">
                                    <input type="text" class="option-text" placeholder="الخيار الثالث" style="flex: 1; padding: 14px; border-radius: var(--radius-sm); border: 1px solid rgba(108, 99, 255, 0.2);">
                                    <input type="radio" name="correct-${questionId}" value="2">
                                    <span style="color: var(--primary-color); font-weight: 600;">الإجابة الصحيحة</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 18px; padding: 18px; background: rgba(93, 95, 239, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(93, 95, 239, 0.1);">
                                    <input type="text" class="option-text" placeholder="الخيار الرابع" style="flex: 1; padding: 14px; border-radius: var(--radius-sm); border: 1px solid rgba(108, 99, 255, 0.2);">
                                    <input type="radio" name="correct-${questionId}" value="3">
                                    <span style="color: var(--primary-color); font-weight: 600;">الإجابة الصحيحة</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>الدرجة</label>
                            <input type="number" class="question-score" min="1" max="10" value="1" required style="padding: 16px; border-radius: var(--radius-md);">
                        </div>
                    </div>
                `;
            } else if (type === 'truefalse') {
                questionHtml = `
                    <div class="card question-item" id="question-${questionId}" style="margin-bottom: 30px; padding: 30px; border-left: 5px solid var(--warning-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                            <h4 style="color: var(--warning-color); font-weight: 800;"><i class="fas fa-check-circle"></i> سؤال صح وخطأ</h4>
                            <button type="button" class="btn btn-danger btn-sm" onclick="removeQuestion(${questionId})" style="padding: 10px 18px;">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 25px;">
                            <label>نص السؤال</label>
                            <input type="text" class="question-text" placeholder="أدخل نص السؤال" required style="padding: 16px; border-radius: var(--radius-md);">
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 25px;">
                            <label>الإجابة الصحيحة</label>
                            <select class="correct-answer" required style="padding: 16px; border-radius: var(--radius-md);">
                                <option value="true">صح</option>
                                <option value="false">خطأ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>الدرجة</label>
                            <input type="number" class="question-score" min="1" max="10" value="1" required style="padding: 16px; border-radius: var(--radius-md);">
                        </div>
                    </div>
                `;
            } else if (type === 'essay') {
                questionHtml = `
                    <div class="card question-item" id="question-${questionId}" style="margin-bottom: 30px; padding: 30px; border-left: 5px solid var(--success-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                            <h4 style="color: var(--success-color); font-weight: 800;"><i class="fas fa-pen-alt"></i> سؤال مقالي</h4>
                            <button type="button" class="btn btn-danger btn-sm" onclick="removeQuestion(${questionId})" style="padding: 10px 18px;">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 25px;">
                            <label>نص السؤال</label>
                            <textarea class="question-text" rows="3" placeholder="أدخل نص السؤال" required style="padding: 16px; border-radius: var(--radius-md);"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>الدرجة العظمى</label>
                            <input type="number" class="question-score" min="1" max="20" value="5" required style="padding: 16px; border-radius: var(--radius-md);">
                        </div>
                    </div>
                `;
            }
            
            questionsContainer.innerHTML += questionHtml;
        }

        // حذف سؤال
        function removeQuestion(questionId) {
            const questionElement = document.getElementById(`question-${questionId}`);
            if (questionElement) {
                questionElement.remove();
            }
        }

        // حفظ الاختبار
        function saveExam() {
            alert('تم حفظ الاختبار بنجاح! (في التطبيق الكامل سيتم حفظه في قاعدة البيانات)');
            goToDashboard();
        }

        // الحصول على عنوان الصفحة
        function getPageTitle(page) {
            const titles = {
                'dashboard': 'لوحة التحكم',
                'universities': 'إدارة الجامعات',
                'majors': 'إدارة التخصصات',
                'subjects': 'إدارة المواد',
                'groups': 'إدارة المجموعات',
                'students': 'إدارة الطلاب',
                'users': 'إدارة المستخدمين',
                'reports': 'التقارير والإحصائيات',
                'mySubjects': 'موادي الدراسية',
                'myGroups': 'مجموعاتي',
                'createExam': 'إنشاء اختبار جديد',
                'myExams': 'اختباراتي',
                'results': 'نتائج الطلاب',
                'availableExams': 'الاختبارات المتاحة',
                'myResults': 'نتائجي',
                'myProfile': 'ملفي الشخصي'
            };
            
            return titles[page] || 'صفحة غير معروفة';
        }

        // وظائف إدارة الجامعات
        function showAddUniversityModal() {
            const modalHtml = `
                <div id="addUniversityModal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;z-index:2000;backdrop-filter:blur(5px);">
                    <div style="background:white;width:550px;max-width:90%;border-radius:var(--radius-lg);padding:35px;box-shadow:var(--shadow-xl);">
                        <h3 style="color:var(--secondary-color);margin-bottom:25px;text-align:center;font-weight:800;">إضافة جامعة جديدة</h3>
                        <form id="addUniversityForm">
                            <div class="form-group">
                                <label>اسم الجامعة</label>
                                <input type="text" id="universityName" placeholder="أدخل اسم الجامعة" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>المدينة/الموقع</label>
                                <input type="text" id="universityLocation" placeholder="أدخل موقع الجامعة" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>سنة التأسيس</label>
                                <input type="number" id="universityYear" min="1900" max="2024" value="2000" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>وصف الجامعة (اختياري)</label>
                                <textarea id="universityDescription" rows="3" placeholder="أدخل وصفاً للجامعة" style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);"></textarea>
                            </div>
                            <div style="display:flex;gap:18px;justify-content:center;margin-top:35px;">
                                <button type="submit" class="btn btn-success" style="padding:14px 35px;">حفظ</button>
                                <button type="button" class="btn btn-danger" onclick="closeModal()" style="padding:14px 35px;">إلغاء</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            document.getElementById('addUniversityForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addNewUniversity();
            });
        }

        function addNewUniversity() {
            const name = document.getElementById('universityName').value;
            const location = document.getElementById('universityLocation').value;
            const year = document.getElementById('universityYear').value;
            
            if (name && location && year) {
                alert(`تم إضافة جامعة ${name} بنجاح!`);
                closeModal();
                loadUniversitiesManagement();
            }
        }

        function viewUniversityDetails(universityId) {
            const university = sampleData.universities.find(u => u.id == universityId);
            if (!university) return;
            
            alert(`عرض تفاصيل جامعة ${university.name}\n\nالموقع: ${university.location}\nسنة التأسيس: ${university.established}`);
        }

        function editUniversity(universityId) {
            const university = sampleData.universities.find(u => u.id == universityId);
            if (!university) return;
            
            const newName = prompt('اسم الجامعة الجديد:', university.name);
            if (newName) university.name = newName;
            
            const newLocation = prompt('الموقع الجديد:', university.location);
            if (newLocation) university.location = newLocation;
            
            alert('تم تحديث بيانات الجامعة بنجاح!');
            loadUniversitiesManagement();
        }

        function deleteUniversity(universityId) {
            if (confirm('هل أنت متأكد من حذف هذه الجامعة؟ سيتم حذف جميع التخصصات المرتبطة بها.')) {
                alert('تم حذف الجامعة بنجاح!');
                loadUniversitiesManagement();
            }
        }

        // وظائف إدارة التخصصات
        function showAddMajorModal(universityName = '') {
            const modalHtml = `
                <div id="addMajorModal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;z-index:2000;backdrop-filter:blur(5px);">
                    <div style="background:white;width:550px;max-width:90%;border-radius:var(--radius-lg);padding:35px;box-shadow:var(--shadow-xl);">
                        <h3 style="color:var(--secondary-color);margin-bottom:25px;text-align:center;font-weight:800;">إضافة تخصص جديد</h3>
                        <form id="addMajorForm">
                            <div class="form-group">
                                <label>اسم التخصص</label>
                                <input type="text" id="majorName" placeholder="أدخل اسم التخصص" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>القسم الأكاديمي</label>
                                <input type="text" id="majorDepartment" placeholder="أدخل اسم القسم" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>الجامعة</label>
                                <select id="majorUniversity" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                                    <option value="">اختر الجامعة</option>
                                    ${sampleData.universities.map(u => `
                                        <option value="${u.name}" ${u.name === universityName ? 'selected' : ''}>${u.name}</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>وصف التخصص (اختياري)</label>
                                <textarea id="majorDescription" rows="3" placeholder="أدخل وصفاً للتخصص" style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);"></textarea>
                            </div>
                            <div style="display:flex;gap:18px;justify-content:center;margin-top:35px;">
                                <button type="submit" class="btn btn-success" style="padding:14px 35px;">حفظ</button>
                                <button type="button" class="btn btn-danger" onclick="closeModal()" style="padding:14px 35px;">إلغاء</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            document.getElementById('addMajorForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addNewMajor();
            });
        }

        function addNewMajor() {
            const name = document.getElementById('majorName').value;
            const department = document.getElementById('majorDepartment').value;
            const university = document.getElementById('majorUniversity').value;
            
            if (name && department && university) {
                alert(`تم إضافة تخصص ${name} بنجاح!`);
                closeModal();
                loadMajorsManagement();
            }
        }

        function viewMajorDetails(majorId) {
            const major = sampleData.majors.find(m => m.id == majorId);
            if (!major) return;
            
            alert(`عرض تفاصيل تخصص ${major.name}\n\nالقسم: ${major.department}\nالجامعة: ${major.university}`);
        }

        function editMajor(majorId) {
            const major = sampleData.majors.find(m => m.id == majorId);
            if (!major) return;
            
            const newName = prompt('اسم التخصص الجديد:', major.name);
            if (newName) major.name = newName;
            
            const newDepartment = prompt('القسم الجديد:', major.department);
            if (newDepartment) major.department = newDepartment;
            
            alert('تم تحديث بيانات التخصص بنجاح!');
            loadMajorsManagement();
        }

        function deleteMajor(majorId) {
            if (confirm('هل أنت متأكد من حذف هذا التخصص؟')) {
                alert('تم حذف التخصص بنجاح!');
                loadMajorsManagement();
            }
        }

        // وظائف إدارة المستخدمين
        function showAddUserModal() {
            const modalHtml = `
                <div id="addUserModal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;z-index:2000;backdrop-filter:blur(5px);">
                    <div style="background:white;width:550px;max-width:90%;border-radius:var(--radius-lg);padding:35px;box-shadow:var(--shadow-xl);">
                        <h3 style="color:var(--secondary-color);margin-bottom:25px;text-align:center;font-weight:800;">إضافة مستخدم جديد</h3>
                        <form id="addUserForm">
                            <div class="form-group">
                                <label>اسم المستخدم الكامل</label>
                                <input type="text" id="userName" placeholder="أدخل الاسم الكامل" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>البريد الإلكتروني</label>
                                <input type="email" id="userEmail" placeholder="أدخل البريد الإلكتروني" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>كلمة المرور</label>
                                <input type="password" id="userPassword" placeholder="أدخل كلمة المرور" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div class="form-group">
                                <label>نوع المستخدم</label>
                                <select id="userType" required style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                                    <option value="student">طالب</option>
                                    <option value="teacher">مدرس</option>
                                    <option value="admin">مدير</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>رقم الهاتف</label>
                                <input type="tel" id="userPhone" placeholder="أدخل رقم الهاتف" style="padding:14px;border-radius:var(--radius-md);border:2px solid rgba(108, 99, 255, 0.2);">
                            </div>
                            <div style="display:flex;gap:18px;justify-content:center;margin-top:35px;">
                                <button type="submit" class="btn btn-success" style="padding:14px 35px;">حفظ</button>
                                <button type="button" class="btn btn-danger" onclick="closeModal()" style="padding:14px 35px;">إلغاء</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            document.getElementById('addUserForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addNewUser();
            });
        }

        function addNewUser() {
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;
            const password = document.getElementById('userPassword').value;
            const type = document.getElementById('userType').value;
            const phone = document.getElementById('userPhone').value;
            
            if (name && email && password && type) {
                alert(`تم إضافة المستخدم ${name} بنجاح!`);
                closeModal();
                loadUsersManagement();
            }
        }

        function viewUserDetails(userId) {
            alert(`عرض تفاصيل المستخدم رقم ${userId} - هذه الميزة قيد التطوير`);
        }

        function editUser(userId) {
            alert(`تعديل المستخدم رقم ${userId} - هذه الميزة قيد التطوير`);
        }

        function deleteUser(userId) {
            if (confirm('هل أنت متأكد من حذف هذا المستخدم؟')) {
                alert('تم حذف المستخدم بنجاح!');
                loadUsersManagement();
            }
        }

        function toggleUserStatus(userId, status) {
            const statusText = status === 'active' ? 'تفعيل' : 'تعطيل';
            if (confirm(`هل أنت متأكد من ${statusText} هذا المستخدم؟`)) {
                alert(`تم ${statusText} المستخدم بنجاح!`);
                loadUsersManagement();
            }
        }

        function filterUsers() {
            alert('تم تطبيق عوامل التصفية بنجاح!');
        }

        // وظيفة إغلاق النوافذ المنبثقة
        function closeModal() {
            const modals = document.querySelectorAll('[id$="Modal"]');
            modals.forEach(modal => modal.remove());
        }

        // وظائف مساعدة
        function editSubject(subjectId) {
            alert(`تعديل المادة رقم ${subjectId} - هذه الميزة قيد التطوير`);
        }

        function viewGroupStudents(groupName) {
            alert(`عرض طلاب المجموعة ${groupName} - هذه الميزة قيد التطوير`);
        }

        function viewGroupExams(groupName) {
            alert(`عرض اختبارات المجموعة ${groupName} - هذه الميزة قيد التطوير`);
        }

        function viewGroupDetails(groupName) {
            alert(`عرض تفاصيل المجموعة ${groupName} - هذه الميزة قيد التطوير`);
        }

        function addNewStudent() {
            alert('إضافة طالب جديد - هذه الميزة قيد التطوير');
        }

        function addNewSubject() {
            alert('إضافة مادة جديدة - هذه الميزة قيد التطوير');
        }

        function addNewGroup() {
            alert('إضافة مجموعة جديدة - هذه الميزة قيد التطوير');
        }
    </script>
</body>
</html>